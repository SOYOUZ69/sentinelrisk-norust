import{Jb as je,Kb as Ve,Nb as ze,R as ke,S as Fe,U as He,_ as Ee,d as le,e as Me,f as Q,j as Ne,n as ve,o as Pe,r as De,s as Oe,t as ge}from"./chunk-QYV7G3Z4.js";var be=le(pe=>{"use strict";pe.byteLength=dr;pe.toByteArray=xr;pe.fromByteArray=yr;var Z=[],Y=[],lr=typeof Uint8Array<"u"?Uint8Array:Array,Ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(oe=0,Je=Ae.length;oe<Je;++oe)Z[oe]=Ae[oe],Y[Ae.charCodeAt(oe)]=oe;var oe,Je;Y[45]=62;Y[95]=63;function Ke(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function dr(t){var e=Ke(t),r=e[0],n=e[1];return(r+n)*3/4-n}function pr(t,e,r){return(e+r)*3/4-r}function xr(t){var e,r=Ke(t),n=r[0],o=r[1],a=new lr(pr(t,n,o)),c=0,k=o>0?n-4:n,u;for(u=0;u<k;u+=4)e=Y[t.charCodeAt(u)]<<18|Y[t.charCodeAt(u+1)]<<12|Y[t.charCodeAt(u+2)]<<6|Y[t.charCodeAt(u+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=e&255;return o===2&&(e=Y[t.charCodeAt(u)]<<2|Y[t.charCodeAt(u+1)]>>4,a[c++]=e&255),o===1&&(e=Y[t.charCodeAt(u)]<<10|Y[t.charCodeAt(u+1)]<<4|Y[t.charCodeAt(u+2)]>>2,a[c++]=e>>8&255,a[c++]=e&255),a}function wr(t){return Z[t>>18&63]+Z[t>>12&63]+Z[t>>6&63]+Z[t&63]}function mr(t,e,r){for(var n,o=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(t[a+2]&255),o.push(wr(n));return o.join("")}function yr(t){for(var e,r=t.length,n=r%3,o=[],a=16383,c=0,k=r-n;c<k;c+=a)o.push(mr(t,c,c+a>k?k:c+a));return n===1?(e=t[r-1],o.push(Z[e>>2]+Z[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],o.push(Z[e>>10]+Z[e>>4&63]+Z[e<<2&63]+"=")),o.join("")}});var Ye=le(()=>{"use strict"});var We=le(Ue=>{"use strict";Ue.read=function(t,e,r,n,o){var a,c,k=o*8-n-1,u=(1<<k)-1,_=u>>1,S=-7,I=r?o-1:0,D=r?-1:1,C=t[e+I];for(I+=D,a=C&(1<<-S)-1,C>>=-S,S+=k;S>0;a=a*256+t[e+I],I+=D,S-=8);for(c=a&(1<<-S)-1,a>>=-S,S+=n;S>0;c=c*256+t[e+I],I+=D,S-=8);if(a===0)a=1-_;else{if(a===u)return c?NaN:(C?-1:1)*(1/0);c=c+Math.pow(2,n),a=a-_}return(C?-1:1)*c*Math.pow(2,a-n)};Ue.write=function(t,e,r,n,o,a){var c,k,u,_=a*8-o-1,S=(1<<_)-1,I=S>>1,D=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=n?0:a-1,W=n?1:-1,ce=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(k=isNaN(e)?1:0,c=S):(c=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-c))<1&&(c--,u*=2),c+I>=1?e+=D/u:e+=D*Math.pow(2,1-I),e*u>=2&&(c++,u/=2),c+I>=S?(k=0,c=S):c+I>=1?(k=(e*u-1)*Math.pow(2,o),c=c+I):(k=e*Math.pow(2,I-1)*Math.pow(2,o),c=0));o>=8;t[r+C]=k&255,C+=W,k/=256,o-=8);for(c=c<<o|k,_+=o;_>0;t[r+C]=c&255,C+=W,c/=256,_-=8);t[r+C-W]|=ce*128}});var ar=le(fe=>{"use strict";var Se=be(),ue=We(),$e=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;fe.Buffer=f;fe.SlowBuffer=Ar;fe.INSPECT_MAX_BYTES=50;var xe=2147483647;fe.kMaxLength=xe;f.TYPED_ARRAY_SUPPORT=vr();!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function vr(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}});Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function re(t){if(t>xe)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,f.prototype),e}function f(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Re(t)}return qe(t,e,r)}f.poolSize=8192;function qe(t,e,r){if(typeof t=="string")return kr(t,e);if(ArrayBuffer.isView(t))return Fr(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(ee(t,ArrayBuffer)||t&&ee(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ee(t,SharedArrayBuffer)||t&&ee(t.buffer,SharedArrayBuffer)))return Ie(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return f.from(n,e,r);var o=Er(t);if(o)return o;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return f.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}f.from=function(t,e,r){return qe(t,e,r)};Object.setPrototypeOf(f.prototype,Uint8Array.prototype);Object.setPrototypeOf(f,Uint8Array);function Qe(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function gr(t,e,r){return Qe(t),t<=0?re(t):e!==void 0?typeof r=="string"?re(t).fill(e,r):re(t).fill(e):re(t)}f.alloc=function(t,e,r){return gr(t,e,r)};function Re(t){return Qe(t),re(t<0?0:Be(t)|0)}f.allocUnsafe=function(t){return Re(t)};f.allocUnsafeSlow=function(t){return Re(t)};function kr(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!f.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=Ze(t,e)|0,n=re(r),o=n.write(t,e);return o!==r&&(n=n.slice(0,o)),n}function _e(t){for(var e=t.length<0?0:Be(t.length)|0,r=re(e),n=0;n<e;n+=1)r[n]=t[n]&255;return r}function Fr(t){if(ee(t,Uint8Array)){var e=new Uint8Array(t);return Ie(e.buffer,e.byteOffset,e.byteLength)}return _e(t)}function Ie(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,f.prototype),n}function Er(t){if(f.isBuffer(t)){var e=Be(t.length)|0,r=re(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||Ce(t.length)?re(0):_e(t);if(t.type==="Buffer"&&Array.isArray(t.data))return _e(t.data)}function Be(t){if(t>=xe)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+xe.toString(16)+" bytes");return t|0}function Ar(t){return+t!=t&&(t=0),f.alloc(+t)}f.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==f.prototype};f.compare=function(e,r){if(ee(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),ee(r,Uint8Array)&&(r=f.from(r,r.offset,r.byteLength)),!f.isBuffer(e)||!f.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,o=r.length,a=0,c=Math.min(n,o);a<c;++a)if(e[a]!==r[a]){n=e[a],o=r[a];break}return n<o?-1:o<n?1:0};f.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};f.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return f.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var o=f.allocUnsafe(r),a=0;for(n=0;n<e.length;++n){var c=e[n];if(ee(c,Uint8Array))a+c.length>o.length?f.from(c).copy(o,a):Uint8Array.prototype.set.call(o,c,a);else if(f.isBuffer(c))c.copy(o,a);else throw new TypeError('"list" argument must be an Array of Buffers');a+=c.length}return o};function Ze(t,e){if(f.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||ee(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Te(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return or(t).length;default:if(o)return n?-1:Te(t).length;e=(""+e).toLowerCase(),o=!0}}f.byteLength=Ze;function br(t,e,r){var n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return Mr(this,e,r);case"utf8":case"utf-8":return rr(this,e,r);case"ascii":return Cr(this,e,r);case"latin1":case"binary":return Lr(this,e,r);case"base64":return Rr(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Nr(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}f.prototype._isBuffer=!0;function ae(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}f.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)ae(this,r,r+1);return this};f.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)ae(this,r,r+3),ae(this,r+1,r+2);return this};f.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)ae(this,r,r+7),ae(this,r+1,r+6),ae(this,r+2,r+5),ae(this,r+3,r+4);return this};f.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?rr(this,0,e):br.apply(this,arguments)};f.prototype.toLocaleString=f.prototype.toString;f.prototype.equals=function(e){if(!f.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:f.compare(this,e)===0};f.prototype.inspect=function(){var e="",r=fe.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};$e&&(f.prototype[$e]=f.prototype.inspect);f.prototype.compare=function(e,r,n,o,a){if(ee(e,Uint8Array)&&(e=f.from(e,e.offset,e.byteLength)),!f.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),o===void 0&&(o=0),a===void 0&&(a=this.length),r<0||n>e.length||o<0||a>this.length)throw new RangeError("out of range index");if(o>=a&&r>=n)return 0;if(o>=a)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,o>>>=0,a>>>=0,this===e)return 0;for(var c=a-o,k=n-r,u=Math.min(c,k),_=this.slice(o,a),S=e.slice(r,n),I=0;I<u;++I)if(_[I]!==S[I]){c=_[I],k=S[I];break}return c<k?-1:k<c?1:0};function er(t,e,r,n,o){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Ce(r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0)if(o)r=0;else return-1;if(typeof e=="string"&&(e=f.from(e,n)),f.isBuffer(e))return e.length===0?-1:Xe(t,e,r,n,o);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):Xe(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function Xe(t,e,r,n,o){var a=1,c=t.length,k=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;a=2,c/=2,k/=2,r/=2}function u(C,W){return a===1?C[W]:C.readUInt16BE(W*a)}var _;if(o){var S=-1;for(_=r;_<c;_++)if(u(t,_)===u(e,S===-1?0:_-S)){if(S===-1&&(S=_),_-S+1===k)return S*a}else S!==-1&&(_-=_-S),S=-1}else for(r+k>c&&(r=c-k),_=r;_>=0;_--){for(var I=!0,D=0;D<k;D++)if(u(t,_+D)!==u(e,D)){I=!1;break}if(I)return _}return-1}f.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};f.prototype.indexOf=function(e,r,n){return er(this,e,r,n,!0)};f.prototype.lastIndexOf=function(e,r,n){return er(this,e,r,n,!1)};function Ur(t,e,r,n){r=Number(r)||0;var o=t.length-r;n?(n=Number(n),n>o&&(n=o)):n=o;var a=e.length;n>a/2&&(n=a/2);for(var c=0;c<n;++c){var k=parseInt(e.substr(c*2,2),16);if(Ce(k))return c;t[r+c]=k}return c}function Sr(t,e,r,n){return we(Te(e,t.length-r),t,r,n)}function _r(t,e,r,n){return we(Or(e),t,r,n)}function Ir(t,e,r,n){return we(or(e),t,r,n)}function Tr(t,e,r,n){return we(Hr(e,t.length-r),t,r,n)}f.prototype.write=function(e,r,n,o){if(r===void 0)o="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")o=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,o===void 0&&(o="utf8")):(o=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a=this.length-r;if((n===void 0||n>a)&&(n=a),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var c=!1;;)switch(o){case"hex":return Ur(this,e,r,n);case"utf8":case"utf-8":return Sr(this,e,r,n);case"ascii":case"latin1":case"binary":return _r(this,e,r,n);case"base64":return Ir(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Tr(this,e,r,n);default:if(c)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),c=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Rr(t,e,r){return e===0&&r===t.length?Se.fromByteArray(t):Se.fromByteArray(t.slice(e,r))}function rr(t,e,r){r=Math.min(t.length,r);for(var n=[],o=e;o<r;){var a=t[o],c=null,k=a>239?4:a>223?3:a>191?2:1;if(o+k<=r){var u,_,S,I;switch(k){case 1:a<128&&(c=a);break;case 2:u=t[o+1],(u&192)===128&&(I=(a&31)<<6|u&63,I>127&&(c=I));break;case 3:u=t[o+1],_=t[o+2],(u&192)===128&&(_&192)===128&&(I=(a&15)<<12|(u&63)<<6|_&63,I>2047&&(I<55296||I>57343)&&(c=I));break;case 4:u=t[o+1],_=t[o+2],S=t[o+3],(u&192)===128&&(_&192)===128&&(S&192)===128&&(I=(a&15)<<18|(u&63)<<12|(_&63)<<6|S&63,I>65535&&I<1114112&&(c=I))}}c===null?(c=65533,k=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|c&1023),n.push(c),o+=k}return Br(n)}var Ge=4096;function Br(t){var e=t.length;if(e<=Ge)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Ge));return r}function Cr(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]&127);return n}function Lr(t,e,r){var n="";r=Math.min(t.length,r);for(var o=e;o<r;++o)n+=String.fromCharCode(t[o]);return n}function Mr(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var o="",a=e;a<r;++a)o+=jr[t[a]];return o}function Nr(t,e,r){for(var n=t.slice(e,r),o="",a=0;a<n.length-1;a+=2)o+=String.fromCharCode(n[a]+n[a+1]*256);return o}f.prototype.slice=function(e,r){var n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var o=this.subarray(e,r);return Object.setPrototypeOf(o,f.prototype),o};function O(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||O(e,r,this.length);for(var o=this[e],a=1,c=0;++c<r&&(a*=256);)o+=this[e+c]*a;return o};f.prototype.readUintBE=f.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||O(e,r,this.length);for(var o=this[e+--r],a=1;r>0&&(a*=256);)o+=this[e+--r]*a;return o};f.prototype.readUint8=f.prototype.readUInt8=function(e,r){return e=e>>>0,r||O(e,1,this.length),this[e]};f.prototype.readUint16LE=f.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||O(e,2,this.length),this[e]|this[e+1]<<8};f.prototype.readUint16BE=f.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||O(e,2,this.length),this[e]<<8|this[e+1]};f.prototype.readUint32LE=f.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};f.prototype.readUint32BE=f.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||O(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};f.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||O(e,r,this.length);for(var o=this[e],a=1,c=0;++c<r&&(a*=256);)o+=this[e+c]*a;return a*=128,o>=a&&(o-=Math.pow(2,8*r)),o};f.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||O(e,r,this.length);for(var o=r,a=1,c=this[e+--o];o>0&&(a*=256);)c+=this[e+--o]*a;return a*=128,c>=a&&(c-=Math.pow(2,8*r)),c};f.prototype.readInt8=function(e,r){return e=e>>>0,r||O(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};f.prototype.readInt16LE=function(e,r){e=e>>>0,r||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};f.prototype.readInt16BE=function(e,r){e=e>>>0,r||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};f.prototype.readInt32LE=function(e,r){return e=e>>>0,r||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};f.prototype.readInt32BE=function(e,r){return e=e>>>0,r||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};f.prototype.readFloatLE=function(e,r){return e=e>>>0,r||O(e,4,this.length),ue.read(this,e,!0,23,4)};f.prototype.readFloatBE=function(e,r){return e=e>>>0,r||O(e,4,this.length),ue.read(this,e,!1,23,4)};f.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||O(e,8,this.length),ue.read(this,e,!0,52,8)};f.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||O(e,8,this.length),ue.read(this,e,!1,52,8)};function z(t,e,r,n,o,a){if(!f.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<a)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(e,r,n,o){if(e=+e,r=r>>>0,n=n>>>0,!o){var a=Math.pow(2,8*n)-1;z(this,e,r,n,a,0)}var c=1,k=0;for(this[r]=e&255;++k<n&&(c*=256);)this[r+k]=e/c&255;return r+n};f.prototype.writeUintBE=f.prototype.writeUIntBE=function(e,r,n,o){if(e=+e,r=r>>>0,n=n>>>0,!o){var a=Math.pow(2,8*n)-1;z(this,e,r,n,a,0)}var c=n-1,k=1;for(this[r+c]=e&255;--c>=0&&(k*=256);)this[r+c]=e/k&255;return r+n};f.prototype.writeUint8=f.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,1,255,0),this[r]=e&255,r+1};f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};f.prototype.writeIntLE=function(e,r,n,o){if(e=+e,r=r>>>0,!o){var a=Math.pow(2,8*n-1);z(this,e,r,n,a-1,-a)}var c=0,k=1,u=0;for(this[r]=e&255;++c<n&&(k*=256);)e<0&&u===0&&this[r+c-1]!==0&&(u=1),this[r+c]=(e/k>>0)-u&255;return r+n};f.prototype.writeIntBE=function(e,r,n,o){if(e=+e,r=r>>>0,!o){var a=Math.pow(2,8*n-1);z(this,e,r,n,a-1,-a)}var c=n-1,k=1,u=0;for(this[r+c]=e&255;--c>=0&&(k*=256);)e<0&&u===0&&this[r+c+1]!==0&&(u=1),this[r+c]=(e/k>>0)-u&255;return r+n};f.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};f.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};f.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};f.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};f.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||z(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function tr(t,e,r,n,o,a){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function nr(t,e,r,n,o){return e=+e,r=r>>>0,o||tr(t,e,r,4,34028234663852886e22,-34028234663852886e22),ue.write(t,e,r,n,23,4),r+4}f.prototype.writeFloatLE=function(e,r,n){return nr(this,e,r,!0,n)};f.prototype.writeFloatBE=function(e,r,n){return nr(this,e,r,!1,n)};function ir(t,e,r,n,o){return e=+e,r=r>>>0,o||tr(t,e,r,8,17976931348623157e292,-17976931348623157e292),ue.write(t,e,r,n,52,8),r+8}f.prototype.writeDoubleLE=function(e,r,n){return ir(this,e,r,!0,n)};f.prototype.writeDoubleBE=function(e,r,n){return ir(this,e,r,!1,n)};f.prototype.copy=function(e,r,n,o){if(!f.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!o&&o!==0&&(o=this.length),r>=e.length&&(r=e.length),r||(r=0),o>0&&o<n&&(o=n),o===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-r<o-n&&(o=e.length-r+n);var a=o-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,o):Uint8Array.prototype.set.call(e,this.subarray(n,o),r),a};f.prototype.fill=function(e,r,n,o){if(typeof e=="string"){if(typeof r=="string"?(o=r,r=0,n=this.length):typeof n=="string"&&(o=n,n=this.length),o!==void 0&&typeof o!="string")throw new TypeError("encoding must be a string");if(typeof o=="string"&&!f.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(e.length===1){var a=e.charCodeAt(0);(o==="utf8"&&a<128||o==="latin1")&&(e=a)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);var c;if(typeof e=="number")for(c=r;c<n;++c)this[c]=e;else{var k=f.isBuffer(e)?e:f.from(e,o),u=k.length;if(u===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(c=0;c<n-r;++c)this[c+r]=k[c%u]}return this};var Pr=/[^+/0-9A-Za-z-_]/g;function Dr(t){if(t=t.split("=")[0],t=t.trim().replace(Pr,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function Te(t,e){e=e||1/0;for(var r,n=t.length,o=null,a=[],c=0;c<n;++c){if(r=t.charCodeAt(c),r>55295&&r<57344){if(!o){if(r>56319){(e-=3)>-1&&a.push(239,191,189);continue}else if(c+1===n){(e-=3)>-1&&a.push(239,191,189);continue}o=r;continue}if(r<56320){(e-=3)>-1&&a.push(239,191,189),o=r;continue}r=(o-55296<<10|r-56320)+65536}else o&&(e-=3)>-1&&a.push(239,191,189);if(o=null,r<128){if((e-=1)<0)break;a.push(r)}else if(r<2048){if((e-=2)<0)break;a.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;a.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return a}function Or(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function Hr(t,e){for(var r,n,o,a=[],c=0;c<t.length&&!((e-=2)<0);++c)r=t.charCodeAt(c),n=r>>8,o=r%256,a.push(o),a.push(n);return a}function or(t){return Se.toByteArray(Dr(t))}function we(t,e,r,n){for(var o=0;o<n&&!(o+r>=e.length||o>=t.length);++o)e[o+r]=t[o];return o}function ee(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function Ce(t){return t!==t}var jr=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=r*16,o=0;o<16;++o)e[n+o]=t[r]+t[o];return e}()});var sr=le((qr,me)=>{"use strict";(function(){"use strict";var t="input is invalid type",e=typeof window=="object",r=e?window:{};r.JS_SHA256_NO_WINDOW&&(e=!1);var n=!e&&typeof self=="object",o=!r.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;o?r=global:n&&(r=self);var a=!r.JS_SHA256_NO_COMMON_JS&&typeof me=="object"&&me.exports,c=typeof define=="function"&&define.amd,k=!r.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",u="0123456789abcdef".split(""),_=[-2147483648,8388608,32768,128],S=[24,16,8,0],I=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],D=["hex","array","digest","arrayBuffer"],C=[];(r.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(h){return Object.prototype.toString.call(h)==="[object Array]"}),k&&(r.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(h){return typeof h=="object"&&h.buffer&&h.buffer.constructor===ArrayBuffer});var W=function(h,v){return function(U){return new P(v,!0).update(U)[h]()}},ce=function(h){var v=W("hex",h);o&&(v=$(v,h)),v.create=function(){return new P(h)},v.update=function(E){return v.create().update(E)};for(var U=0;U<D.length;++U){var g=D[U];v[g]=W(g,h)}return v},$=function(h,v){var U=Ye(),g=ar().Buffer,E=v?"sha224":"sha256",y;g.from&&!r.JS_SHA256_NO_BUFFER_FROM?y=g.from:y=function(p){return new g(p)};var B=function(p){if(typeof p=="string")return U.createHash(E).update(p,"utf8").digest("hex");if(p==null)throw new Error(t);return p.constructor===ArrayBuffer&&(p=new Uint8Array(p)),Array.isArray(p)||ArrayBuffer.isView(p)||p.constructor===g?U.createHash(E).update(y(p)).digest("hex"):h(p)};return B},de=function(h,v){return function(U,g){return new ie(U,v,!0).update(g)[h]()}},G=function(h){var v=de("hex",h);v.create=function(E){return new ie(E,h)},v.update=function(E,y){return v.create(E).update(y)};for(var U=0;U<D.length;++U){var g=D[U];v[g]=de(g,h)}return v};function P(h,v){v?(C[0]=C[16]=C[1]=C[2]=C[3]=C[4]=C[5]=C[6]=C[7]=C[8]=C[9]=C[10]=C[11]=C[12]=C[13]=C[14]=C[15]=0,this.blocks=C):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=h}P.prototype.update=function(h){if(!this.finalized){var v,U=typeof h;if(U!=="string"){if(U==="object"){if(h===null)throw new Error(t);if(k&&h.constructor===ArrayBuffer)h=new Uint8Array(h);else if(!Array.isArray(h)&&(!k||!ArrayBuffer.isView(h)))throw new Error(t)}else throw new Error(t);v=!0}for(var g,E=0,y,B=h.length,p=this.blocks;E<B;){if(this.hashed&&(this.hashed=!1,p[0]=this.block,p[16]=p[1]=p[2]=p[3]=p[4]=p[5]=p[6]=p[7]=p[8]=p[9]=p[10]=p[11]=p[12]=p[13]=p[14]=p[15]=0),v)for(y=this.start;E<B&&y<64;++E)p[y>>2]|=h[E]<<S[y++&3];else for(y=this.start;E<B&&y<64;++E)g=h.charCodeAt(E),g<128?p[y>>2]|=g<<S[y++&3]:g<2048?(p[y>>2]|=(192|g>>6)<<S[y++&3],p[y>>2]|=(128|g&63)<<S[y++&3]):g<55296||g>=57344?(p[y>>2]|=(224|g>>12)<<S[y++&3],p[y>>2]|=(128|g>>6&63)<<S[y++&3],p[y>>2]|=(128|g&63)<<S[y++&3]):(g=65536+((g&1023)<<10|h.charCodeAt(++E)&1023),p[y>>2]|=(240|g>>18)<<S[y++&3],p[y>>2]|=(128|g>>12&63)<<S[y++&3],p[y>>2]|=(128|g>>6&63)<<S[y++&3],p[y>>2]|=(128|g&63)<<S[y++&3]);this.lastByteIndex=y,this.bytes+=y-this.start,y>=64?(this.block=p[16],this.start=y-64,this.hash(),this.hashed=!0):this.start=y}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},P.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var h=this.blocks,v=this.lastByteIndex;h[16]=this.block,h[v>>2]|=_[v&3],this.block=h[16],v>=56&&(this.hashed||this.hash(),h[0]=this.block,h[16]=h[1]=h[2]=h[3]=h[4]=h[5]=h[6]=h[7]=h[8]=h[9]=h[10]=h[11]=h[12]=h[13]=h[14]=h[15]=0),h[14]=this.hBytes<<3|this.bytes>>>29,h[15]=this.bytes<<3,this.hash()}},P.prototype.hash=function(){var h=this.h0,v=this.h1,U=this.h2,g=this.h3,E=this.h4,y=this.h5,B=this.h6,p=this.h7,R=this.blocks,N,H,j,J,L,X,i,s,d,m,l;for(N=16;N<64;++N)L=R[N-15],H=(L>>>7|L<<25)^(L>>>18|L<<14)^L>>>3,L=R[N-2],j=(L>>>17|L<<15)^(L>>>19|L<<13)^L>>>10,R[N]=R[N-16]+H+R[N-7]+j<<0;for(l=v&U,N=0;N<64;N+=4)this.first?(this.is224?(s=300032,L=R[0]-1413257819,p=L-150054599<<0,g=L+24177077<<0):(s=704751109,L=R[0]-210244248,p=L-1521486534<<0,g=L+143694565<<0),this.first=!1):(H=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),j=(E>>>6|E<<26)^(E>>>11|E<<21)^(E>>>25|E<<7),s=h&v,J=s^h&U^l,i=E&y^~E&B,L=p+j+i+I[N]+R[N],X=H+J,p=g+L<<0,g=L+X<<0),H=(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10),j=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),d=g&h,J=d^g&v^s,i=p&E^~p&y,L=B+j+i+I[N+1]+R[N+1],X=H+J,B=U+L<<0,U=L+X<<0,H=(U>>>2|U<<30)^(U>>>13|U<<19)^(U>>>22|U<<10),j=(B>>>6|B<<26)^(B>>>11|B<<21)^(B>>>25|B<<7),m=U&g,J=m^U&h^d,i=B&p^~B&E,L=y+j+i+I[N+2]+R[N+2],X=H+J,y=v+L<<0,v=L+X<<0,H=(v>>>2|v<<30)^(v>>>13|v<<19)^(v>>>22|v<<10),j=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7),l=v&U,J=l^v&g^m,i=y&B^~y&p,L=E+j+i+I[N+3]+R[N+3],X=H+J,E=h+L<<0,h=L+X<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+h<<0,this.h1=this.h1+v<<0,this.h2=this.h2+U<<0,this.h3=this.h3+g<<0,this.h4=this.h4+E<<0,this.h5=this.h5+y<<0,this.h6=this.h6+B<<0,this.h7=this.h7+p<<0},P.prototype.hex=function(){this.finalize();var h=this.h0,v=this.h1,U=this.h2,g=this.h3,E=this.h4,y=this.h5,B=this.h6,p=this.h7,R=u[h>>28&15]+u[h>>24&15]+u[h>>20&15]+u[h>>16&15]+u[h>>12&15]+u[h>>8&15]+u[h>>4&15]+u[h&15]+u[v>>28&15]+u[v>>24&15]+u[v>>20&15]+u[v>>16&15]+u[v>>12&15]+u[v>>8&15]+u[v>>4&15]+u[v&15]+u[U>>28&15]+u[U>>24&15]+u[U>>20&15]+u[U>>16&15]+u[U>>12&15]+u[U>>8&15]+u[U>>4&15]+u[U&15]+u[g>>28&15]+u[g>>24&15]+u[g>>20&15]+u[g>>16&15]+u[g>>12&15]+u[g>>8&15]+u[g>>4&15]+u[g&15]+u[E>>28&15]+u[E>>24&15]+u[E>>20&15]+u[E>>16&15]+u[E>>12&15]+u[E>>8&15]+u[E>>4&15]+u[E&15]+u[y>>28&15]+u[y>>24&15]+u[y>>20&15]+u[y>>16&15]+u[y>>12&15]+u[y>>8&15]+u[y>>4&15]+u[y&15]+u[B>>28&15]+u[B>>24&15]+u[B>>20&15]+u[B>>16&15]+u[B>>12&15]+u[B>>8&15]+u[B>>4&15]+u[B&15];return this.is224||(R+=u[p>>28&15]+u[p>>24&15]+u[p>>20&15]+u[p>>16&15]+u[p>>12&15]+u[p>>8&15]+u[p>>4&15]+u[p&15]),R},P.prototype.toString=P.prototype.hex,P.prototype.digest=function(){this.finalize();var h=this.h0,v=this.h1,U=this.h2,g=this.h3,E=this.h4,y=this.h5,B=this.h6,p=this.h7,R=[h>>24&255,h>>16&255,h>>8&255,h&255,v>>24&255,v>>16&255,v>>8&255,v&255,U>>24&255,U>>16&255,U>>8&255,U&255,g>>24&255,g>>16&255,g>>8&255,g&255,E>>24&255,E>>16&255,E>>8&255,E&255,y>>24&255,y>>16&255,y>>8&255,y&255,B>>24&255,B>>16&255,B>>8&255,B&255];return this.is224||R.push(p>>24&255,p>>16&255,p>>8&255,p&255),R},P.prototype.array=P.prototype.digest,P.prototype.arrayBuffer=function(){this.finalize();var h=new ArrayBuffer(this.is224?28:32),v=new DataView(h);return v.setUint32(0,this.h0),v.setUint32(4,this.h1),v.setUint32(8,this.h2),v.setUint32(12,this.h3),v.setUint32(16,this.h4),v.setUint32(20,this.h5),v.setUint32(24,this.h6),this.is224||v.setUint32(28,this.h7),h};function ie(h,v,U){var g,E=typeof h;if(E==="string"){var y=[],B=h.length,p=0,R;for(g=0;g<B;++g)R=h.charCodeAt(g),R<128?y[p++]=R:R<2048?(y[p++]=192|R>>6,y[p++]=128|R&63):R<55296||R>=57344?(y[p++]=224|R>>12,y[p++]=128|R>>6&63,y[p++]=128|R&63):(R=65536+((R&1023)<<10|h.charCodeAt(++g)&1023),y[p++]=240|R>>18,y[p++]=128|R>>12&63,y[p++]=128|R>>6&63,y[p++]=128|R&63);h=y}else if(E==="object"){if(h===null)throw new Error(t);if(k&&h.constructor===ArrayBuffer)h=new Uint8Array(h);else if(!Array.isArray(h)&&(!k||!ArrayBuffer.isView(h)))throw new Error(t)}else throw new Error(t);h.length>64&&(h=new P(v,!0).update(h).array());var N=[],H=[];for(g=0;g<64;++g){var j=h[g]||0;N[g]=92^j,H[g]=54^j}P.call(this,v,U),this.update(H),this.oKeyPad=N,this.inner=!0,this.sharedMemory=U}ie.prototype=new P,ie.prototype.finalize=function(){if(P.prototype.finalize.call(this),this.inner){this.inner=!1;var h=this.array();P.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(h),P.prototype.finalize.call(this)}};var V=ce();V.sha256=V,V.sha224=ce(!0),V.sha256.hmac=G(),V.sha224.hmac=G(!0),a?me.exports=V:(r.sha256=V.sha256,r.sha224=V.sha224,c&&define(function(){return V}))})()});var cr=Me(be(),1),ur=Me(sr(),1);var se=class extends Error{};se.prototype.name="InvalidTokenError";function Vr(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function zr(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Vr(e)}catch{return atob(e)}}function ye(t,e){if(typeof t!="string")throw new se("Invalid token specified: must be a string");e||(e={});let r=e.header===!0?0:1,n=t.split(".")[r];if(typeof n!="string")throw new se(`Invalid token specified: missing part #${r+1}`);let o;try{o=zr(n)}catch(a){throw new se(`Invalid token specified: invalid base64 for part #${r+1} (${a.message})`)}try{return JSON.parse(o)}catch(a){throw new se(`Invalid token specified: invalid json for part #${r+1} (${a.message})`)}}if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");function Le(t){if(!(this instanceof Le))throw new Error("The 'Keycloak' constructor must be invoked with 'new'.");for(var e=this,r,n=[],o,a={enable:!0,callbackList:[],interval:5},c=document.getElementsByTagName("script"),k=0;k<c.length;k++)(c[k].src.indexOf("keycloak.js")!==-1||c[k].src.indexOf("keycloak.min.js")!==-1)&&c[k].src.indexOf("version=")!==-1&&(e.iframeVersion=c[k].src.substring(c[k].src.indexOf("version=")+8).split("&")[0]);var u=!0,_=X(console.info),S=X(console.warn);e.init=function(i){if(e.didInitialize)throw new Error("A 'Keycloak' instance can only be initialized once.");e.didInitialize=!0,e.authenticated=!1,o=L();var s=["default","cordova","cordova-native"];if(i&&s.indexOf(i.adapter)>-1?r=H(i.adapter):i&&typeof i.adapter=="object"?r=i.adapter:window.Cordova||window.cordova?r=H("cordova"):r=H(),i){if(typeof i.useNonce<"u"&&(u=i.useNonce),typeof i.checkLoginIframe<"u"&&(a.enable=i.checkLoginIframe),i.checkLoginIframeInterval&&(a.interval=i.checkLoginIframeInterval),i.onLoad==="login-required"&&(e.loginRequired=!0),i.responseMode)if(i.responseMode==="query"||i.responseMode==="fragment")e.responseMode=i.responseMode;else throw"Invalid value for responseMode";if(i.flow){switch(i.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=i.flow}if(i.timeSkew!=null&&(e.timeSkew=i.timeSkew),i.redirectUri&&(e.redirectUri=i.redirectUri),i.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=i.silentCheckSsoRedirectUri),typeof i.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=i.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,i.pkceMethod){if(i.pkceMethod!=="S256")throw"Invalid value for pkceMethod";e.pkceMethod=i.pkceMethod}typeof i.enableLogging=="boolean"?e.enableLogging=i.enableLogging:e.enableLogging=!1,typeof i.scope=="string"&&(e.scope=i.scope),typeof i.acrValues=="string"&&(e.acrValues=i.acrValues),typeof i.messageReceiveTimeout=="number"&&i.messageReceiveTimeout>0?e.messageReceiveTimeout=i.messageReceiveTimeout:e.messageReceiveTimeout=1e4}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var d=E(),m=E();m.promise.then(function(){e.onReady&&e.onReady(e.authenticated),d.setSuccess(e.authenticated)}).catch(function(A){d.setError(A)});var l=P();function F(){var A=function(M){M||(T.prompt="none"),i&&i.locale&&(T.locale=i.locale),e.login(T).then(function(){m.setSuccess()}).catch(function(q){m.setError(q)})},b=function(){var M=document.createElement("iframe"),q=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});M.setAttribute("src",q),M.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),M.setAttribute("title","keycloak-silent-check-sso"),M.style.display="none",document.body.appendChild(M);var ne=function(K){if(!(K.origin!==window.location.origin||M.contentWindow!==K.source)){var he=v(K.data);G(he,m),document.body.removeChild(M),window.removeEventListener("message",ne)}};window.addEventListener("message",ne)},T={};switch(i.onLoad){case"check-sso":a.enable?B().then(function(){R().then(function(M){M?m.setSuccess():e.silentCheckSsoRedirectUri?b():A(!1)}).catch(function(M){m.setError(M)})}):e.silentCheckSsoRedirectUri?b():A(!1);break;case"login-required":A(!0);break;default:throw"Invalid value for onLoad"}}function x(){var A=v(window.location.href);if(A&&window.history.replaceState(window.history.state,null,A.newUrl),A&&A.valid)return B().then(function(){G(A,m)}).catch(function(b){m.setError(b)});i?i.token&&i.refreshToken?(V(i.token,i.refreshToken,i.idToken),a.enable?B().then(function(){R().then(function(b){b?(e.onAuthSuccess&&e.onAuthSuccess(),m.setSuccess(),p()):m.setSuccess()}).catch(function(b){m.setError(b)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),m.setSuccess()}).catch(function(b){e.onAuthError&&e.onAuthError(),i.onLoad?F():m.setError(b)})):i.onLoad?F():m.setSuccess():m.setSuccess()}function w(){var A=E(),b=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",b),A.setSuccess())};return document.addEventListener("readystatechange",b),b(),A.promise}return l.then(function(){w().then(N).then(x).catch(function(A){d.setError(A)})}),l.catch(function(A){d.setError(A)}),d.promise},e.login=function(i){return r.login(i)};function I(i){var s=null,d=window.crypto||window.msCrypto;if(d&&d.getRandomValues&&window.Uint8Array)return s=new Uint8Array(i),d.getRandomValues(s),s;s=new Array(i);for(var m=0;m<s.length;m++)s[m]=Math.floor(256*Math.random());return s}function D(i){return C(i,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function C(i,s){for(var d=I(i),m=new Array(i),l=0;l<i;l++)m[l]=s.charCodeAt(d[l]%s.length);return String.fromCharCode.apply(null,m)}function W(i,s){switch(i){case"S256":var d=new Uint8Array(ur.default.arrayBuffer(s)),m=cr.default.fromByteArray(d).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return m;default:throw"Invalid value for pkceMethod"}}function ce(i){var s={id_token:{acr:i}};return JSON.stringify(s)}e.createLoginUrl=function(i){var s=h(),d=h(),m=r.redirectUri(i),l={state:s,nonce:d,redirectUri:encodeURIComponent(m)};i&&i.prompt&&(l.prompt=i.prompt);var F;i&&i.action=="register"?F=e.endpoints.register():F=e.endpoints.authorize();var x=i&&i.scope||e.scope;x?x.indexOf("openid")===-1&&(x="openid "+x):x="openid";var w=F+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(m)+"&state="+encodeURIComponent(s)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(x);if(u&&(w=w+"&nonce="+encodeURIComponent(d)),i&&i.prompt&&(w+="&prompt="+encodeURIComponent(i.prompt)),i&&i.maxAge&&(w+="&max_age="+encodeURIComponent(i.maxAge)),i&&i.loginHint&&(w+="&login_hint="+encodeURIComponent(i.loginHint)),i&&i.idpHint&&(w+="&kc_idp_hint="+encodeURIComponent(i.idpHint)),i&&i.action&&i.action!="register"&&(w+="&kc_action="+encodeURIComponent(i.action)),i&&i.locale&&(w+="&ui_locales="+encodeURIComponent(i.locale)),i&&i.acr){var A=ce(i.acr);w+="&claims="+encodeURIComponent(A)}if((i&&i.acrValues||e.acrValues)&&(w+="&acr_values="+encodeURIComponent(i.acrValues||e.acrValues)),e.pkceMethod){var b=D(96);l.pkceCodeVerifier=b;var T=W(e.pkceMethod,b);w+="&code_challenge="+T,w+="&code_challenge_method="+e.pkceMethod}return o.add(l),w},e.logout=function(i){return r.logout(i)},e.createLogoutUrl=function(i){var s=e.endpoints.logout()+"?client_id="+encodeURIComponent(e.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(r.redirectUri(i,!1));return e.idToken&&(s+="&id_token_hint="+encodeURIComponent(e.idToken)),s},e.register=function(i){return r.register(i)},e.createRegisterUrl=function(i){return i||(i={}),i.action="register",e.createLoginUrl(i)},e.createAccountUrl=function(i){var s=$(),d=void 0;return typeof s<"u"&&(d=s+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(r.redirectUri(i))),d},e.accountManagement=function(){return r.accountManagement()},e.hasRealmRole=function(i){var s=e.realmAccess;return!!s&&s.roles.indexOf(i)>=0},e.hasResourceRole=function(i,s){if(!e.resourceAccess)return!1;var d=e.resourceAccess[s||e.clientId];return!!d&&d.roles.indexOf(i)>=0},e.loadUserProfile=function(){var i=$()+"/account",s=new XMLHttpRequest;s.open("GET",i,!0),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Authorization","bearer "+e.token);var d=E();return s.onreadystatechange=function(){s.readyState==4&&(s.status==200?(e.profile=JSON.parse(s.responseText),d.setSuccess(e.profile)):d.setError())},s.send(),d.promise},e.loadUserInfo=function(){var i=e.endpoints.userinfo(),s=new XMLHttpRequest;s.open("GET",i,!0),s.setRequestHeader("Accept","application/json"),s.setRequestHeader("Authorization","bearer "+e.token);var d=E();return s.onreadystatechange=function(){s.readyState==4&&(s.status==200?(e.userInfo=JSON.parse(s.responseText),d.setSuccess(e.userInfo)):d.setError())},s.send(),d.promise},e.isTokenExpired=function(i){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return _("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var s=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(i){if(isNaN(i))throw"Invalid minValidity";s-=i}return s<0},e.updateToken=function(i){var s=E();if(!e.refreshToken)return s.setError(),s.promise;i=i||5;var d=function(){var l=!1;if(i==-1?(l=!0,_("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(i))&&(l=!0,_("[KEYCLOAK] Refreshing token: token expired")),!l)s.setSuccess(!1);else{var F="grant_type=refresh_token&refresh_token="+e.refreshToken,x=e.endpoints.token();if(n.push(s),n.length==1){var w=new XMLHttpRequest;w.open("POST",x,!0),w.setRequestHeader("Content-type","application/x-www-form-urlencoded"),w.withCredentials=!0,F+="&client_id="+encodeURIComponent(e.clientId);var A=new Date().getTime();w.onreadystatechange=function(){if(w.readyState==4)if(w.status==200){_("[KEYCLOAK] Token refreshed"),A=(A+new Date().getTime())/2;var b=JSON.parse(w.responseText);V(b.access_token,b.refresh_token,b.id_token,A),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var T=n.pop();T!=null;T=n.pop())T.setSuccess(!0)}else{S("[KEYCLOAK] Failed to refresh token"),w.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var T=n.pop();T!=null;T=n.pop())T.setError(!0)}},w.send(F)}}};if(a.enable){var m=R();m.then(function(){d()}).catch(function(l){s.setError(l)})}else d();return s.promise},e.clearToken=function(){e.token&&(V(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function $(){if(typeof e.authServerUrl<"u")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function de(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function G(i,s){var d=i.code,m=i.error,l=i.prompt,F=new Date().getTime();if(i.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(i.kc_action_status),m){if(l!="none"){var x={error:m,error_description:i.error_description};e.onAuthError&&e.onAuthError(x),s&&s.setError(x)}else s&&s.setSuccess();return}else e.flow!="standard"&&(i.access_token||i.id_token)&&T(i.access_token,null,i.id_token,!0);if(e.flow!="implicit"&&d){var w="code="+d+"&grant_type=authorization_code",A=e.endpoints.token(),b=new XMLHttpRequest;b.open("POST",A,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),w+="&client_id="+encodeURIComponent(e.clientId),w+="&redirect_uri="+i.redirectUri,i.pkceCodeVerifier&&(w+="&code_verifier="+i.pkceCodeVerifier),b.withCredentials=!0,b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200){var M=JSON.parse(b.responseText);T(M.access_token,M.refresh_token,M.id_token,e.flow==="standard"),p()}else e.onAuthError&&e.onAuthError(),s&&s.setError()},b.send(w)}function T(M,q,ne,K){F=(F+new Date().getTime())/2,V(M,q,ne,F),u&&(e.tokenParsed&&e.tokenParsed.nonce!=i.storedNonce||e.refreshTokenParsed&&e.refreshTokenParsed.nonce!=i.storedNonce||e.idTokenParsed&&e.idTokenParsed.nonce!=i.storedNonce)?(_("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),s&&s.setError()):K&&(e.onAuthSuccess&&e.onAuthSuccess(),s&&s.setSuccess())}}function P(i){var s=E(),d;t?typeof t=="string"&&(d=t):d="keycloak.json";function m(b){b?e.endpoints={authorize:function(){return b.authorization_endpoint},token:function(){return b.token_endpoint},logout:function(){if(!b.end_session_endpoint)throw"Not supported by the OIDC server";return b.end_session_endpoint},checkSessionIframe:function(){if(!b.check_session_iframe)throw"Not supported by the OIDC server";return b.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!b.userinfo_endpoint)throw"Not supported by the OIDC server";return b.userinfo_endpoint}}:e.endpoints={authorize:function(){return $()+"/protocol/openid-connect/auth"},token:function(){return $()+"/protocol/openid-connect/token"},logout:function(){return $()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var T=$()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(T=T+"?version="+e.iframeVersion),T},thirdPartyCookiesIframe:function(){var T=$()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(T=T+"?version="+e.iframeVersion),T},register:function(){return $()+"/protocol/openid-connect/registrations"},userinfo:function(){return $()+"/protocol/openid-connect/userinfo"}}}if(d){var l=new XMLHttpRequest;l.open("GET",d,!0),l.setRequestHeader("Accept","application/json"),l.onreadystatechange=function(){if(l.readyState==4)if(l.status==200||ie(l)){var b=JSON.parse(l.responseText);e.authServerUrl=b["auth-server-url"],e.realm=b.realm,e.clientId=b.resource,m(null),s.setSuccess()}else s.setError()},l.send()}else{if(!t.clientId)throw"clientId missing";e.clientId=t.clientId;var F=t.oidcProvider;if(F)if(typeof F=="string"){var A;F.charAt(F.length-1)=="/"?A=F+".well-known/openid-configuration":A=F+"/.well-known/openid-configuration";var l=new XMLHttpRequest;l.open("GET",A,!0),l.setRequestHeader("Accept","application/json"),l.onreadystatechange=function(){if(l.readyState==4)if(l.status==200||ie(l)){var T=JSON.parse(l.responseText);m(T),s.setSuccess()}else s.setError()},l.send()}else m(F),s.setSuccess();else{if(!t.url){for(var x=document.getElementsByTagName("script"),w=0;w<x.length;w++)if(x[w].src.match(/.*keycloak\.js/)){t.url=x[w].src.substr(0,x[w].src.indexOf("/js/keycloak.js"));break}}if(!t.realm)throw"realm missing";e.authServerUrl=t.url,e.realm=t.realm,m(null),s.setSuccess()}}return s.promise}function ie(i){return i.status==0&&i.responseText&&i.responseURL.startsWith("file:")}function V(i,s,d,m){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),s?(e.refreshToken=s,e.refreshTokenParsed=ye(s)):(delete e.refreshToken,delete e.refreshTokenParsed),d?(e.idToken=d,e.idTokenParsed=ye(d)):(delete e.idToken,delete e.idTokenParsed),i){if(e.token=i,e.tokenParsed=ye(i),e.sessionId=e.tokenParsed.session_state,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,m&&(e.timeSkew=Math.floor(m/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&(_("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var l=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;_("[KEYCLOAK] Token expires in "+Math.round(l/1e3)+" s"),l<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,l)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function h(){var i="0123456789abcdef",s=C(36,i).split("");s[14]="4",s[19]=i.substr(s[19]&3|8,1),s[8]=s[13]=s[18]=s[23]="-";var d=s.join("");return d}function v(i){var s=U(i);if(s){var d=o.get(s.state);return d&&(s.valid=!0,s.redirectUri=d.redirectUri,s.storedNonce=d.nonce,s.prompt=d.prompt,s.pkceCodeVerifier=d.pkceCodeVerifier),s}}function U(i){var s;switch(e.flow){case"standard":s=["code","state","session_state","kc_action_status","iss"];break;case"implicit":s=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","iss"];break;case"hybrid":s=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","iss"];break}s.push("error"),s.push("error_description"),s.push("error_uri");var d=i.indexOf("?"),m=i.indexOf("#"),l,F;if(e.responseMode==="query"&&d!==-1?(l=i.substring(0,d),F=g(i.substring(d+1,m!==-1?m:i.length),s),F.paramsString!==""&&(l+="?"+F.paramsString),m!==-1&&(l+=i.substring(m))):e.responseMode==="fragment"&&m!==-1&&(l=i.substring(0,m),F=g(i.substring(m+1),s),F.paramsString!==""&&(l+="#"+F.paramsString)),F&&F.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((F.oauthParams.code||F.oauthParams.error)&&F.oauthParams.state)return F.oauthParams.newUrl=l,F.oauthParams}else if(e.flow==="implicit"&&(F.oauthParams.access_token||F.oauthParams.error)&&F.oauthParams.state)return F.oauthParams.newUrl=l,F.oauthParams}}function g(i,s){for(var d=i.split("&"),m={paramsString:"",oauthParams:{}},l=0;l<d.length;l++){var F=d[l].indexOf("="),x=d[l].slice(0,F);s.indexOf(x)!==-1?m.oauthParams[x]=d[l].slice(F+1):(m.paramsString!==""&&(m.paramsString+="&"),m.paramsString+=d[l])}return m}function E(){var i={setSuccess:function(s){i.resolve(s)},setError:function(s){i.reject(s)}};return i.promise=new Promise(function(s,d){i.resolve=s,i.reject=d}),i}function y(i,s,d){var m=null,l=new Promise(function(F,x){m=setTimeout(function(){x({error:d||"Promise is not settled within timeout of "+s+"ms"})},s)});return Promise.race([i,l]).finally(function(){clearTimeout(m)})}function B(){var i=E();if(!a.enable||a.iframe)return i.setSuccess(),i.promise;var s=document.createElement("iframe");a.iframe=s,s.onload=function(){var l=e.endpoints.authorize();l.charAt(0)==="/"?a.iframeOrigin=de():a.iframeOrigin=l.substring(0,l.indexOf("/",8)),i.setSuccess()};var d=e.endpoints.checkSessionIframe();s.setAttribute("src",d),s.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),s.setAttribute("title","keycloak-session-iframe"),s.style.display="none",document.body.appendChild(s);var m=function(l){if(!(l.origin!==a.iframeOrigin||a.iframe.contentWindow!==l.source)&&(l.data=="unchanged"||l.data=="changed"||l.data=="error")){l.data!="unchanged"&&e.clearToken();for(var F=a.callbackList.splice(0,a.callbackList.length),x=F.length-1;x>=0;--x){var w=F[x];l.data=="error"?w.setError():w.setSuccess(l.data=="unchanged")}}};return window.addEventListener("message",m,!1),i.promise}function p(){a.enable&&e.token&&setTimeout(function(){R().then(function(i){i&&p()})},a.interval*1e3)}function R(){var i=E();if(a.iframe&&a.iframeOrigin){var s=e.clientId+" "+(e.sessionId?e.sessionId:"");a.callbackList.push(i);var d=a.iframeOrigin;a.callbackList.length==1&&a.iframe.contentWindow.postMessage(s,d)}else i.setSuccess();return i.promise}function N(){var i=E();if(a.enable||e.silentCheckSsoRedirectUri){var s=document.createElement("iframe");s.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),s.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),s.setAttribute("title","keycloak-3p-check-iframe"),s.style.display="none",document.body.appendChild(s);var d=function(m){s.contentWindow===m.source&&(m.data!=="supported"&&m.data!=="unsupported"||(m.data==="unsupported"&&(S(`[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:

 - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).
 - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).

For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers`),a.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1)),document.body.removeChild(s),window.removeEventListener("message",d),i.setSuccess()))};window.addEventListener("message",d,!1)}else i.setSuccess();return y(i.promise,e.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function H(i){if(!i||i=="default")return{login:function(x){return window.location.assign(e.createLoginUrl(x)),E().promise},logout:function(x){return window.location.replace(e.createLogoutUrl(x)),E().promise},register:function(x){return window.location.assign(e.createRegisterUrl(x)),E().promise},accountManagement:function(){var x=e.createAccountUrl();if(typeof x<"u")window.location.href=x;else throw"Not supported by the OIDC server";return E().promise},redirectUri:function(x,w){return x&&x.redirectUri?x.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(i=="cordova"){a.enable=!1;var s=function(x,w,A){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(x,w,A):window.open(x,w,A)},d=function(x){return x&&x.cordovaOptions?Object.keys(x.cordovaOptions).reduce(function(w,A){return w[A]=x.cordovaOptions[A],w},{}):{}},m=function(x){return Object.keys(x).reduce(function(w,A){return w.push(A+"="+x[A]),w},[]).join(",")},l=function(x){var w=d(x);return w.location="no",x&&x.prompt=="none"&&(w.hidden="yes"),m(w)},F=function(){return e.redirectUri||"http://localhost"};return{login:function(x){var w=E(),A=l(x),b=e.createLoginUrl(x),T=s(b,"_blank",A),M=!1,q=!1,ne=function(){q=!0,T.close()};return T.addEventListener("loadstart",function(K){if(K.url.indexOf(F())==0){var he=v(K.url);G(he,w),ne(),M=!0}}),T.addEventListener("loaderror",function(K){if(!M)if(K.url.indexOf(F())==0){var he=v(K.url);G(he,w),ne(),M=!0}else w.setError(),ne()}),T.addEventListener("exit",function(K){q||w.setError({reason:"closed_by_user"})}),w.promise},logout:function(x){var w=E(),A=e.createLogoutUrl(x),b=s(A,"_blank","location=no,hidden=yes,clearcache=yes"),T;return b.addEventListener("loadstart",function(M){M.url.indexOf(F())==0&&b.close()}),b.addEventListener("loaderror",function(M){M.url.indexOf(F())==0||(T=!0),b.close()}),b.addEventListener("exit",function(M){T?w.setError():(e.clearToken(),w.setSuccess())}),w.promise},register:function(x){var w=E(),A=e.createRegisterUrl(),b=l(x),T=s(A,"_blank",b);return T.addEventListener("loadstart",function(M){if(M.url.indexOf(F())==0){T.close();var q=v(M.url);G(q,w)}}),w.promise},accountManagement:function(){var x=e.createAccountUrl();if(typeof x<"u"){var w=s(x,"_blank","location=no");w.addEventListener("loadstart",function(A){A.url.indexOf(F())==0&&w.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(x){return F()}}}if(i=="cordova-native")return a.enable=!1,{login:function(x){var w=E(),A=e.createLoginUrl(x);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var T=v(b.url);G(T,w)}),window.cordova.plugins.browsertab.openUrl(A),w.promise},logout:function(x){var w=E(),A=e.createLogoutUrl(x);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),w.setSuccess()}),window.cordova.plugins.browsertab.openUrl(A),w.promise},register:function(x){var w=E(),A=e.createRegisterUrl(x);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var T=v(b.url);G(T,w)}),window.cordova.plugins.browsertab.openUrl(A),w.promise},accountManagement:function(){var x=e.createAccountUrl();if(typeof x<"u")window.cordova.plugins.browsertab.openUrl(x);else throw"Not supported by the OIDC server"},redirectUri:function(x){return x&&x.redirectUri?x.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+i}var j=function(){if(!(this instanceof j))return new j;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var i=this;function s(){for(var d=new Date().getTime(),m=0;m<localStorage.length;m++){var l=localStorage.key(m);if(l&&l.indexOf("kc-callback-")==0){var F=localStorage.getItem(l);if(F)try{var x=JSON.parse(F).expires;(!x||x<d)&&localStorage.removeItem(l)}catch{localStorage.removeItem(l)}}}}i.get=function(d){if(d){var m="kc-callback-"+d,l=localStorage.getItem(m);return l&&(localStorage.removeItem(m),l=JSON.parse(l)),s(),l}},i.add=function(d){s();var m="kc-callback-"+d.state;d.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(m,JSON.stringify(d))}},J=function(){if(!(this instanceof J))return new J;var i=this;i.get=function(l){if(l){var F=d("kc-callback-"+l);if(m("kc-callback-"+l,"",s(-100)),F)return JSON.parse(F)}},i.add=function(l){m("kc-callback-"+l.state,JSON.stringify(l),s(60))},i.removeItem=function(l){m(l,"",s(-100))};var s=function(l){var F=new Date;return F.setTime(F.getTime()+l*60*1e3),F},d=function(l){for(var F=l+"=",x=document.cookie.split(";"),w=0;w<x.length;w++){for(var A=x[w];A.charAt(0)==" ";)A=A.substring(1);if(A.indexOf(F)==0)return A.substring(F.length,A.length)}return""},m=function(l,F,x){var w=l+"="+F+"; expires="+x.toUTCString()+"; ";document.cookie=w}};function L(){try{return new j}catch{}return new J}function X(i){return function(){e.enableLogging&&i.apply(console,Array.prototype.slice.call(arguments))}}}var te=function(t){return t[t.OnAuthError=0]="OnAuthError",t[t.OnAuthLogout=1]="OnAuthLogout",t[t.OnAuthRefreshError=2]="OnAuthRefreshError",t[t.OnAuthRefreshSuccess=3]="OnAuthRefreshSuccess",t[t.OnAuthSuccess=4]="OnAuthSuccess",t[t.OnReady=5]="OnReady",t[t.OnTokenExpired=6]="OnTokenExpired",t[t.OnActionUpdate=7]="OnActionUpdate",t}(te||{}),fr=class{constructor(e,r){this.router=e,this.keycloakAngular=r}canActivate(e,r){return Q(this,null,function*(){try{return this.authenticated=yield this.keycloakAngular.isLoggedIn(),this.roles=yield this.keycloakAngular.getUserRoles(!0),yield this.isAccessAllowed(e,r)}catch(n){throw new Error("An error happened during access validation. Details:"+n)}})}},hr=(()=>{class t{constructor(){this._keycloakEvents$=new Ne}bindsKeycloakEvents(){this._instance.onAuthError=r=>{this._keycloakEvents$.next({args:r,type:te.OnAuthError})},this._instance.onAuthLogout=()=>{this._keycloakEvents$.next({type:te.OnAuthLogout})},this._instance.onAuthRefreshSuccess=()=>{this._keycloakEvents$.next({type:te.OnAuthRefreshSuccess})},this._instance.onAuthRefreshError=()=>{this._keycloakEvents$.next({type:te.OnAuthRefreshError})},this._instance.onAuthSuccess=()=>{this._keycloakEvents$.next({type:te.OnAuthSuccess})},this._instance.onTokenExpired=()=>{this._keycloakEvents$.next({type:te.OnTokenExpired})},this._instance.onActionUpdate=r=>{this._keycloakEvents$.next({args:r,type:te.OnActionUpdate})},this._instance.onReady=r=>{this._keycloakEvents$.next({args:r,type:te.OnReady})}}loadExcludedUrls(r){let n=[];for(let o of r){let a;typeof o=="string"?a={urlPattern:new RegExp(o,"i"),httpMethods:[]}:a={urlPattern:new RegExp(o.url,"i"),httpMethods:o.httpMethods},n.push(a)}return n}initServiceValues({enableBearerInterceptor:r=!0,loadUserProfileAtStartUp:n=!1,bearerExcludedUrls:o=[],authorizationHeaderName:a="Authorization",bearerPrefix:c="Bearer",initOptions:k,updateMinValidity:u=20,shouldAddToken:_=()=>!0,shouldUpdateToken:S=()=>!0}){this._enableBearerInterceptor=r,this._loadUserProfileAtStartUp=n,this._authorizationHeaderName=a,this._bearerPrefix=c.trim().concat(" "),this._excludedUrls=this.loadExcludedUrls(o),this._silentRefresh=k?k.flow==="implicit":!1,this._updateMinValidity=u,this.shouldAddToken=_,this.shouldUpdateToken=S}init(){return Q(this,arguments,function*(r={}){this.initServiceValues(r);let{config:n,initOptions:o}=r;this._instance=new Le(n),this.bindsKeycloakEvents();let a=yield this._instance.init(o);return a&&this._loadUserProfileAtStartUp&&(yield this.loadUserProfile()),a})}login(){return Q(this,arguments,function*(r={}){yield this._instance.login(r),this._loadUserProfileAtStartUp&&(yield this.loadUserProfile())})}logout(r){return Q(this,null,function*(){let n={redirectUri:r};yield this._instance.logout(n),this._userProfile=void 0})}register(){return Q(this,arguments,function*(r={action:"register"}){yield this._instance.register(r)})}isUserInRole(r,n){let o;return o=this._instance.hasResourceRole(r,n),o||(o=this._instance.hasRealmRole(r)),o}getUserRoles(r=!0,n){let o=[];if(this._instance.resourceAccess&&Object.keys(this._instance.resourceAccess).forEach(a=>{if(n&&n!==a)return;let k=this._instance.resourceAccess[a].roles||[];o=o.concat(k)}),r&&this._instance.realmAccess){let a=this._instance.realmAccess.roles||[];o.push(...a)}return o}isLoggedIn(){return this._instance?this._instance.authenticated:!1}isTokenExpired(r=0){return this._instance.isTokenExpired(r)}updateToken(){return Q(this,arguments,function*(r=this._updateMinValidity){if(this._silentRefresh){if(this.isTokenExpired())throw new Error("Failed to refresh the token, or the session is expired");return!0}if(!this._instance)throw new Error("Keycloak Angular library is not initialized.");try{return yield this._instance.updateToken(r)}catch{return!1}})}loadUserProfile(r=!1){return Q(this,null,function*(){if(this._userProfile&&!r)return this._userProfile;if(!this._instance.authenticated)throw new Error("The user profile was not loaded as the user is not logged in.");return this._userProfile=yield this._instance.loadUserProfile()})}getToken(){return Q(this,null,function*(){return this._instance.token})}getUsername(){if(!this._userProfile)throw new Error("User not logged in or user profile was not loaded.");return this._userProfile.username}clearToken(){this._instance.clearToken()}addTokenToHeader(r=new Ve){return ve(this.getToken()).pipe(De(n=>n?r.set(this._authorizationHeaderName,this._bearerPrefix+n):r))}getKeycloakInstance(){return this._instance}get excludedUrls(){return this._excludedUrls}get enableBearerInterceptor(){return this._enableBearerInterceptor}get keycloakEvents$(){return this._keycloakEvents$}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=ke({token:t,factory:t.\u0275fac})}}return t})(),Jr=(()=>{class t{constructor(r){this.keycloak=r}conditionallyUpdateToken(r){return Q(this,null,function*(){return this.keycloak.shouldUpdateToken(r)?yield this.keycloak.updateToken():!0})}isUrlExcluded({method:r,url:n},{urlPattern:o,httpMethods:a}){let c=a.length===0||a.join().indexOf(r.toUpperCase())>-1,k=o.test(n);return c&&k}intercept(r,n){let{enableBearerInterceptor:o,excludedUrls:a}=this.keycloak;return!o||!this.keycloak.shouldAddToken(r)||a.findIndex(k=>this.isUrlExcluded(r,k))>-1?n.handle(r):Oe([ve(this.conditionallyUpdateToken(r)),Pe(this.keycloak.isLoggedIn())]).pipe(ge(([k,u])=>u?this.handleRequestWithTokenHeader(r,n):n.handle(r)))}handleRequestWithTokenHeader(r,n){return this.keycloak.addTokenToHeader(r.headers).pipe(ge(o=>{let a=r.clone({headers:o});return n.handle(a)}))}static{this.\u0275fac=function(n){return new(n||t)(He(hr))}}static{this.\u0275prov=ke({token:t,factory:t.\u0275fac})}}return t})(),Kr=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=Ee({type:t})}static{this.\u0275inj=Fe({providers:[hr,{provide:ze,useClass:Jr,multi:!0}],imports:[je]})}}return t})(),st=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=Ee({type:t})}static{this.\u0275inj=Fe({imports:[Kr]})}}return t})();export{fr as a,hr as b,st as c};
