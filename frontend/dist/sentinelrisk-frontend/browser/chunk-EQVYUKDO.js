import{b as k}from"./chunk-5VACTLNG.js";import{d as n}from"./chunk-YNDG7QUW.js";import{S as c,V as u,o as s}from"./chunk-Z6XCGGPI.js";var f=(()=>{class r{constructor(e){this.keycloakAngular=e}init(){return this.keycloakAngular.init({config:{url:n.keycloakUrl,realm:n.keycloakRealm,clientId:n.keycloakClientId},initOptions:{onLoad:"check-sso",silentCheckSsoRedirectUri:window.location.origin+"/assets/silent-check-sso.html"}})}isLoggedIn(){return this.keycloakAngular.isLoggedIn()}login(){return this.keycloakAngular.login()}logout(){return this.keycloakAngular.logout(window.location.origin)}getUserProfile(){return s(this.keycloakAngular.loadUserProfile())}getToken(){return this.keycloakAngular.getToken()}updateToken(e=5){return s(this.keycloakAngular.updateToken(e))}getUserRoles(){return this.keycloakAngular.getUserRoles()}hasRole(e){if(!e)return!1;let o=this.getUserRoles(),t=e.toLowerCase().replace(/^role_/,"");console.debug(`[KeycloakService] V\xE9rification du r\xF4le: ${e} (normalis\xE9: ${t})`),console.debug(`[KeycloakService] R\xF4les utilisateur: ${o.join(", ")}`);let a=o.some(l=>{let i=l.toLowerCase()===t;return console.debug(`[KeycloakService] Comparaison ${l} avec ${e}: ${i}`),i});return console.debug(`[KeycloakService] R\xE9sultat final pour ${e}: ${a}`),a}hasAnyRole(e){return e.some(o=>this.hasRole(o))}getUsername(){let e=this.keycloakAngular.getKeycloakInstance().tokenParsed;return e?e.preferred_username:void 0}logUserRoles(){console.log("User roles:",this.getUserRoles()),["admin","risk_manager","compliance_officer","auditor","user"].forEach(t=>{console.log(`Has role '${t}': ${this.hasRole(t)}`)});let o=this.keycloakAngular.getKeycloakInstance().tokenParsed;console.log("Token data:",o)}static{this.\u0275fac=function(o){return new(o||r)(u(k))}}static{this.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{f as a};
