import{a as Lt}from"./chunk-OPO76HUC.js";import{a as ei,b as ti,c as Be,d as ni}from"./chunk-BHPGXUD5.js";import{a as ii}from"./chunk-TLSZNW5C.js";import{a as Jt}from"./chunk-E5UTYQSB.js";import{a as K}from"./chunk-FTSN34T7.js";import{a as St,b as Pt,c as Dt,d as Ot,f as Tt,h as ge}from"./chunk-YNSTEIOP.js";import{B as Fe,C as Ne,E as Xt,F as je,G as He,H as qe,I as Zt,a as Nt,b as jt,c as Ht,d as qt,e as Bt,f as Vt,g as Gt,h as zt,i as $t,j as Ut,l as Kt,n as Se,o as Qt,p as Pe,q as De,r as Oe,s as Te,t as we,u as Re,v as Ae,w as Le,x as Yt,y as Wt}from"./chunk-WDJEBGND.js";import{$ as Me,A as he,B as xe,D as wt,G as Rt,H as At,Q as _e,R as Ce,T as Ft,V as P,X as be,Y as ve,ba as Ee,c as We,ca as ke,d as Xe,f as ne,g as oe,ga as ye,i as Ze,ia as Ie,u as fe}from"./chunk-AP2XGUVE.js";import{a as $,b as U}from"./chunk-JO4UO2GH.js";import"./chunk-5UYJ4Z3S.js";import{a as A,b as ue,c as z}from"./chunk-R2HLJBYX.js";import{$ as X,$a as Ke,Aa as m,Ab as vt,Ba as $e,Bc as yt,Ca as c,D as at,Da as ut,Db as V,Ea as se,Eb as R,Fa as y,G as W,Ha as gt,Hb as ce,Ic as It,Jb as G,K as rt,La as a,Ma as o,Na as C,Oa as O,Pa as T,Ra as L,S as j,T as H,Tb as Mt,Ua as x,Vb as de,Vc as me,Wa as u,Wb as Et,Xa as Ue,Y as q,Ya as F,Yb as pe,Z as k,Za as ft,_ as B,_a as ht,aa as Ge,ab as Qe,ba as I,bb as xt,ca as S,cb as r,da as st,db as f,eb as h,g as re,ga as lt,gc as kt,j as Ve,ja as ct,jb as le,ka as w,kb as N,lb as Ye,m as nt,ma as ze,mb as _t,oa as s,ob as J,pa as p,qb as ee,ra as dt,rb as Ct,vb as te,xa as pt,xb as ie,y as ot,ya as mt,yb as bt,z as Y,za as Z}from"./chunk-QYV7G3Z4.js";var b=function(t){return t.IDENTIFIED="IDENTIFIED",t.IN_ASSESSMENT="IN_ASSESSMENT",t.MITIGATED="MITIGATED",t.ACCEPTED="ACCEPTED",t.CLOSED="CLOSED",t}(b||{}),v=function(t){return t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.SEVERE="SEVERE",t}(v||{}),M=function(t){return t.RARE="RARE",t.UNLIKELY="UNLIKELY",t.POSSIBLE="POSSIBLE",t.LIKELY="LIKELY",t.ALMOST_CERTAIN="ALMOST_CERTAIN",t}(M||{});function Si(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("name"))}}function Pi(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("description"))}}function Di(t,l){if(t&1&&(a(0,"mat-option",18),r(1),o()),t&2){let e=l.$implicit;c("value",e.id),s(),h(" ",e.name," ")}}function Oi(t,l){t&1&&(a(0,"mat-option",19),r(1,"Chargement..."),o())}function Ti(t,l){t&1&&(a(0,"mat-option",19),r(1," Aucune cat\xE9gorie disponible "),o())}function wi(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("categoryId"))}}function Ri(t,l){if(t&1&&(a(0,"mat-option",18),r(1),o()),t&2){let e=l.$implicit,i=u();c("value",e),s(),h(" ",i.impactTranslations[e]," ")}}function Ai(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("impactLevel"))}}function Li(t,l){if(t&1&&(a(0,"mat-option",18),r(1),o()),t&2){let e=l.$implicit,i=u();c("value",e),s(),h(" ",i.probabilityTranslations[e]," ")}}function Fi(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("probabilityLevel"))}}function Ni(t,l){if(t&1&&(a(0,"mat-option",18),r(1),o()),t&2){let e=l.$implicit,i=u();c("value",e),s(),h(" ",i.statusTranslations[e]," ")}}function ji(t,l){if(t&1&&(a(0,"mat-error"),r(1),o()),t&2){let e=u();s(),f(e.getErrorMessage("status"))}}var oi=(()=>{class t{constructor(e,i,n,d){if(this.fb=e,this.dialogRef=i,this.data=n,this.categoryService=d,this.isEdit=!1,this.categories=[],this.isLoadingCategories=!1,this.statuses=Object.values(b),this.impactLevels=Object.values(v),this.probabilityLevels=Object.values(M),this.statusTranslations={[b.IDENTIFIED]:"Identifi\xE9",[b.IN_ASSESSMENT]:"En \xE9valuation",[b.MITIGATED]:"Att\xE9nu\xE9",[b.ACCEPTED]:"Accept\xE9",[b.CLOSED]:"Cl\xF4tur\xE9"},this.impactTranslations={[v.NEGLIGIBLE]:"N\xE9gligeable",[v.LOW]:"Faible",[v.MEDIUM]:"Moyen",[v.HIGH]:"\xC9lev\xE9",[v.SEVERE]:"S\xE9v\xE8re"},this.probabilityTranslations={[M.RARE]:"Rare",[M.UNLIKELY]:"Peu probable",[M.POSSIBLE]:"Possible",[M.LIKELY]:"Probable",[M.ALMOST_CERTAIN]:"Quasi-certain"},this.isEdit=n.isEdit,this.dialogTitle=this.isEdit?"Modifier le risque":"Ajouter un risque",this.riskForm=this.fb.group({name:["",[P.required,P.minLength(3)]],description:["",P.required],categoryId:["",P.required],impactLevel:[v.MEDIUM,P.required],probabilityLevel:[M.POSSIBLE,P.required],status:[b.IDENTIFIED,P.required],mitigationPlan:[""]}),this.isEdit&&n.risk){let g=n.risk.categoryId||n.risk.category?.id||"";this.riskForm.patchValue({name:n.risk.name,description:n.risk.description,categoryId:g,impactLevel:n.risk.impactLevel,probabilityLevel:n.risk.probabilityLevel,status:n.risk.status,mitigationPlan:n.risk.mitigationPlan||""})}}ngOnInit(){this.categories=[],this.loadCategories()}loadCategories(){this.isLoadingCategories=!0,console.log("Chargement des cat\xE9gories pour le formulaire de risque..."),this.categoryService.getCategories().subscribe({next:e=>{if(console.log("Cat\xE9gories re\xE7ues pour le formulaire de risque:",e),!Array.isArray(e)){console.error("La r\xE9ponse API n'est pas un tableau valide:",e),this.isLoadingCategories=!1,this.categories=[];return}try{this.categories=e.map(i=>i?{id:String(i.id),name:i.name||"(Sans nom)",description:i.description}:null).filter(i=>i!==null),console.log("Cat\xE9gories converties et pr\xEAtes pour le select:",this.categories)}catch(i){console.error("Erreur lors de la conversion des cat\xE9gories:",i),this.categories=[]}this.isLoadingCategories=!1},error:e=>{console.error("Erreur lors du chargement des cat\xE9gories:",e),this.isLoadingCategories=!1,this.categories=[]}})}onSubmit(){if(this.riskForm.valid){let e=this.riskForm.getRawValue(),i=this.categories?this.categories.find(d=>d&&d.id===e.categoryId):void 0,n={name:e.name,description:e.description,categoryId:e.categoryId,categoryName:i?.name||"(Cat\xE9gorie inconnue)",category:{id:e.categoryId,name:i?.name||"(Cat\xE9gorie inconnue)"},impactLevel:e.impactLevel,probabilityLevel:e.probabilityLevel,status:e.status,mitigationPlan:e.mitigationPlan};console.log("Donn\xE9es du risque \xE0 soumettre:",n),this.dialogRef.close(n)}}onCancel(){this.dialogRef.close()}getErrorMessage(e){let i=this.riskForm.get(e);return i?i.hasError("required")?"Ce champ est requis":i.hasError("minlength")?`Minimum ${i.getError("minlength").requiredLength} caract\xE8res`:"":""}static{this.\u0275fac=function(i){return new(i||t)(p(ye),p(Pe),p(De),p(ii))}}static{this.\u0275cmp=k({type:t,selectors:[["app-risk-form-dialog"]],decls:50,vars:16,consts:[["mat-dialog-title",""],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Fuite de donn\xE9es personnelles"],[4,"ngIf"],["matInput","","formControlName","description","placeholder","Description d\xE9taill\xE9e du risque","rows","3"],["formControlName","categoryId"],[3,"value",4,"ngFor","ngForOf"],["disabled","",4,"ngIf"],[1,"form-row"],["appearance","outline"],["formControlName","impactLevel"],["formControlName","probabilityLevel"],["formControlName","status"],["matInput","","formControlName","mitigationPlan","placeholder","D\xE9tails des mesures \xE0 prendre pour att\xE9nuer ce risque","rows","3"],["align","end"],["mat-button","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"],["disabled",""]],template:function(i,n){if(i&1&&(a(0,"h2",0),r(1),o(),a(2,"form",1),x("ngSubmit",function(){return n.onSubmit()}),a(3,"mat-dialog-content")(4,"mat-form-field",2)(5,"mat-label"),r(6,"Nom du risque"),o(),C(7,"input",3),m(8,Si,2,1,"mat-error",4),o(),a(9,"mat-form-field",2)(10,"mat-label"),r(11,"Description"),o(),C(12,"textarea",5),m(13,Pi,2,1,"mat-error",4),o(),a(14,"mat-form-field",2)(15,"mat-label"),r(16,"Cat\xE9gorie"),o(),a(17,"mat-select",6),m(18,Di,2,2,"mat-option",7)(19,Oi,2,0,"mat-option",8)(20,Ti,2,0,"mat-option",8),o(),m(21,wi,2,1,"mat-error",4),o(),a(22,"div",9)(23,"mat-form-field",10)(24,"mat-label"),r(25,"Niveau d'impact"),o(),a(26,"mat-select",11),m(27,Ri,2,2,"mat-option",7),o(),m(28,Ai,2,1,"mat-error",4),o(),a(29,"mat-form-field",10)(30,"mat-label"),r(31,"Niveau de probabilit\xE9"),o(),a(32,"mat-select",12),m(33,Li,2,2,"mat-option",7),o(),m(34,Fi,2,1,"mat-error",4),o()(),a(35,"mat-form-field",2)(36,"mat-label"),r(37,"Statut"),o(),a(38,"mat-select",13),m(39,Ni,2,2,"mat-option",7),o(),m(40,ji,2,1,"mat-error",4),o(),a(41,"mat-form-field",2)(42,"mat-label"),r(43,"Plan de mitigation"),o(),C(44,"textarea",14),o()(),a(45,"mat-dialog-actions",15)(46,"button",16),x("click",function(){return n.onCancel()}),r(47,"Annuler"),o(),a(48,"button",17),r(49),o()()()),i&2){let d,g,_,E,ae,D;s(),f(n.dialogTitle),s(),c("formGroup",n.riskForm),s(6),c("ngIf",(d=n.riskForm.get("name"))==null?null:d.invalid),s(5),c("ngIf",(g=n.riskForm.get("description"))==null?null:g.invalid),s(5),c("ngForOf",n.categories),s(),c("ngIf",n.isLoadingCategories),s(),c("ngIf",!n.isLoadingCategories&&n.categories.length===0),s(),c("ngIf",(_=n.riskForm.get("categoryId"))==null?null:_.invalid),s(6),c("ngForOf",n.impactLevels),s(),c("ngIf",(E=n.riskForm.get("impactLevel"))==null?null:E.invalid),s(5),c("ngForOf",n.probabilityLevels),s(),c("ngIf",(ae=n.riskForm.get("probabilityLevel"))==null?null:ae.invalid),s(5),c("ngForOf",n.statuses),s(),c("ngIf",(D=n.riskForm.get("status"))==null?null:D.invalid),s(8),c("disabled",n.riskForm.invalid),s(),h(" ",n.isEdit?"Mettre \xE0 jour":"Cr\xE9er"," ")}},dependencies:[V,R,Me,Ft,be,ve,Ee,ke,A,Te,Re,we,Fe,Le,Yt,Xt,He,me],styles:["mat-dialog-content[_ngcontent-%COMP%]{min-width:500px}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:8px}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}@media (max-width: 600px){mat-dialog-content[_ngcontent-%COMP%]{min-width:320px}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:0}}"]})}}return t})();function Gi(t,l){t&1&&(a(0,"div",19),C(1,"mat-progress-spinner",20),o())}function zi(t,l){t&1&&(a(0,"th",21),r(1,"Nom"),o())}function $i(t,l){if(t&1&&(a(0,"td",22),r(1),o()),t&2){let e=l.$implicit;s(),f(e.name)}}function Ui(t,l){t&1&&(a(0,"th",21),r(1,"Cat\xE9gorie"),o())}function Ki(t,l){if(t&1&&(a(0,"td",22),r(1),o()),t&2){let e=l.$implicit;s(),f(e.category==null?null:e.category.name)}}function Qi(t,l){t&1&&(a(0,"th",21),r(1,"Impact"),o())}function Yi(t,l){if(t&1&&(a(0,"td",22)(1,"span",23),r(2),o()()),t&2){let e=l.$implicit,i=u();s(),y(i.getImpactClass(e.impactLevel)),s(),h(" ",i.impactTranslations[e.impactLevel]," ")}}function Wi(t,l){t&1&&(a(0,"th",21),r(1,"Probabilit\xE9"),o())}function Xi(t,l){if(t&1&&(a(0,"td",22)(1,"span",24),r(2),o()()),t&2){let e=l.$implicit,i=u();s(),y(i.getProbabilityClass(e.probabilityLevel)),s(),h(" ",i.probabilityTranslations[e.probabilityLevel]," ")}}function Zi(t,l){t&1&&(a(0,"th",21),r(1,"Score"),o())}function Ji(t,l){if(t&1&&(a(0,"td",22)(1,"span",25),r(2),o()()),t&2){let e=l.$implicit,i=u();s(),y(i.getScoreClass(e.score)),s(),h(" ",e.score," ")}}function en(t,l){t&1&&(a(0,"th",21),r(1,"Statut"),o())}function tn(t,l){if(t&1&&(a(0,"td",22)(1,"span",26),r(2),o()()),t&2){let e=l.$implicit,i=u();s(),y(i.getStatusClass(e.status)),s(),h(" ",i.statusTranslations[e.status]," ")}}function nn(t,l){t&1&&(a(0,"th",21),r(1,"Date de cr\xE9ation"),o())}function on(t,l){if(t&1&&(a(0,"td",22),r(1),J(2,"date"),o()),t&2){let e=l.$implicit;s(),f(ee(2,1,e.createdAt,"dd/MM/yyyy"))}}function an(t,l){t&1&&(a(0,"th",21),r(1,"Actions"),o())}function rn(t,l){if(t&1){let e=L();a(0,"td",22)(1,"button",27),x("click",function(){let n=I(e).$implicit,d=u();return S(d.viewRisk(n))}),a(2,"mat-icon"),r(3,"visibility"),o()(),a(4,"button",28),x("click",function(){let n=I(e).$implicit,d=u();return S(d.openRiskForm(n))}),a(5,"mat-icon"),r(6,"edit"),o()(),a(7,"button",29),x("click",function(){let n=I(e).$implicit,d=u();return S(d.deleteRisk(n))}),a(8,"mat-icon"),r(9,"delete"),o()()()}}function sn(t,l){t&1&&C(0,"tr",30)}function ln(t,l){t&1&&C(0,"tr",31)}function cn(t,l){if(t&1){let e=L();a(0,"div",32)(1,"p"),r(2,"Aucun risque trouv\xE9"),o(),a(3,"button",2),x("click",function(){I(e);let n=u();return S(n.openRiskForm())}),r(4," Ajouter un risque "),o()()}}var si=(()=>{class t{constructor(e,i,n,d){this.riskService=e,this.dialog=i,this.snackBar=n,this.router=d,this.risks=[],this.displayedColumns=["name","category","impactLevel","probabilityLevel","score","status","createdAt","actions"],this.isLoading=!1,this.statusTranslations={[b.IDENTIFIED]:"Identifi\xE9",[b.IN_ASSESSMENT]:"En \xE9valuation",[b.MITIGATED]:"Att\xE9nu\xE9",[b.ACCEPTED]:"Accept\xE9",[b.CLOSED]:"Cl\xF4tur\xE9"},this.impactTranslations={[v.NEGLIGIBLE]:"N\xE9gligeable",[v.LOW]:"Faible",[v.MEDIUM]:"Moyen",[v.HIGH]:"\xC9lev\xE9",[v.SEVERE]:"S\xE9v\xE8re"},this.probabilityTranslations={[M.RARE]:"Rare",[M.UNLIKELY]:"Peu probable",[M.POSSIBLE]:"Possible",[M.LIKELY]:"Probable",[M.ALMOST_CERTAIN]:"Quasi-certain"}}ngOnInit(){this.loadRisks()}loadRisks(){this.isLoading=!0,this.riskService.getRisks().subscribe({next:e=>{console.log("Risques r\xE9cup\xE9r\xE9s:",e),this.risks=e,this.isLoading=!1},error:e=>{console.error("Erreur lors du chargement des risques:",e),this.showError("Erreur lors du chargement des risques"),this.isLoading=!1}})}viewRisk(e){e&&e.id?this.router.navigate(["/risks",e.id]):this.showError("Impossible d'acc\xE9der aux d\xE9tails du risque: identifiant manquant")}openRiskForm(e){let i={risk:e,isEdit:!!e};this.dialog.open(oi,{width:"600px",data:i}).afterClosed().subscribe(d=>{d&&(i.isEdit?this.updateRisk(e.id,d):this.createRisk(d))})}deleteRisk(e){let i={title:"Confirmation de suppression",message:`\xCAtes-vous s\xFBr de vouloir supprimer le risque "${e.name}" ?`,confirmText:"Supprimer",cancelText:"Annuler",color:"warn"};this.dialog.open(Zt,{width:"400px",data:i}).afterClosed().subscribe(d=>{d&&this.performDeleteRisk(e.id)})}getScoreClass(e){return e>=15?"very-high":e>=10?"high":e>=5?"medium":e>=3?"low":"very-low"}getStatusClass(e){return e.toLowerCase()}getImpactClass(e){return e.toLowerCase()}getProbabilityClass(e){return e.toLowerCase()}performDeleteRisk(e){this.isLoading=!0,this.riskService.deleteRisk(e).subscribe({next:()=>{this.loadRisks(),this.showSuccess("Risque supprim\xE9 avec succ\xE8s")},error:i=>{console.error("Erreur lors de la suppression du risque:",i),this.showError("Erreur lors de la suppression du risque"),this.isLoading=!1}})}createRisk(e){this.isLoading=!0,console.log("Donn\xE9es du risque envoy\xE9es au backend:",e),this.riskService.createRisk(e).subscribe({next:i=>{console.log("Risque cr\xE9\xE9 avec succ\xE8s:",i),this.loadRisks(),this.showSuccess("Risque cr\xE9\xE9 avec succ\xE8s")},error:i=>{console.error("Erreur d\xE9taill\xE9e lors de la cr\xE9ation du risque:",i);let n="Erreur lors de la cr\xE9ation du risque";i.error&&typeof i.error=="object"&&(i.error.message?n+=": "+i.error.message:i.error.detail&&(n+=": "+i.error.detail),console.log("Champs en erreur:",i.error)),this.showError(n),this.isLoading=!1}})}updateRisk(e,i){this.isLoading=!0,this.riskService.updateRisk(e,i).subscribe({next:()=>{this.loadRisks(),this.showSuccess("Risque mis \xE0 jour avec succ\xE8s")},error:n=>{console.error("Erreur lors de la mise \xE0 jour du risque:",n),this.showError("Erreur lors de la mise \xE0 jour du risque"),this.isLoading=!1}})}showSuccess(e){this.snackBar.open(e,"Fermer",{duration:3e3})}showError(e){this.snackBar.open(e,"Fermer",{duration:3e3,panelClass:["error-snackbar"]})}static{this.\u0275fac=function(i){return new(i||t)(p(K),p(Oe),p(Se),p(de))}}static{this.\u0275cmp=k({type:t,selectors:[["app-risks"]],decls:38,vars:5,consts:[[1,"risks-container"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],[1,"table-container"],["class","loading-shade",4,"ngIf"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","category"],["matColumnDef","impactLevel"],["matColumnDef","probabilityLevel"],["matColumnDef","score"],["matColumnDef","status"],["matColumnDef","createdAt"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","no-data",4,"ngIf"],[1,"loading-shade"],["mode","indeterminate","diameter","50"],["mat-header-cell",""],["mat-cell",""],[1,"impact-badge"],[1,"probability-badge"],[1,"score-badge"],[1,"status-badge"],["mat-icon-button","","color","accent","matTooltip","Voir les d\xE9tails",3,"click"],["mat-icon-button","","color","primary","matTooltip","Modifier",3,"click"],["mat-icon-button","","color","warn","matTooltip","Supprimer",3,"click"],["mat-header-row",""],["mat-row",""],[1,"no-data"]],template:function(i,n){i&1&&(a(0,"div",0)(1,"div",1)(2,"h1"),r(3,"Gestion des risques"),o(),a(4,"button",2),x("click",function(){return n.openRiskForm()}),a(5,"mat-icon"),r(6,"add"),o(),r(7," Nouveau risque "),o()(),a(8,"div",3),m(9,Gi,2,0,"div",4),a(10,"table",5),O(11,6),m(12,zi,2,0,"th",7)(13,$i,2,1,"td",8),T(),O(14,9),m(15,Ui,2,0,"th",7)(16,Ki,2,1,"td",8),T(),O(17,10),m(18,Qi,2,0,"th",7)(19,Yi,3,3,"td",8),T(),O(20,11),m(21,Wi,2,0,"th",7)(22,Xi,3,3,"td",8),T(),O(23,12),m(24,Zi,2,0,"th",7)(25,Ji,3,3,"td",8),T(),O(26,13),m(27,en,2,0,"th",7)(28,tn,3,3,"td",8),T(),O(29,14),m(30,nn,2,0,"th",7)(31,on,3,4,"td",8),T(),O(32,15),m(33,an,2,0,"th",7)(34,rn,10,0,"td",8),T(),m(35,sn,1,0,"tr",16)(36,ln,1,0,"tr",17),o(),m(37,cn,5,0,"div",18),o()()),i&2&&(s(9),c("ngIf",n.isLoading),s(),c("dataSource",n.risks),s(25),c("matHeaderRowDef",n.displayedColumns),s(),c("matRowDefColumns",n.displayedColumns),s(),c("ngIf",!n.isLoading&&n.risks.length===0))},dependencies:[R,Nt,Ht,Gt,qt,jt,zt,Bt,Vt,$t,Ut,A,ue,he,$,_e,ce],styles:[".risks-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.risks-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.risks-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:500}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{overflow-x:auto;position:relative;min-height:200px}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .loading-shade[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0000000d;z-index:1;display:flex;align-items:center;justify-content:center;border-radius:4px}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:500;color:#000000de}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#000000de}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   .mat-column-actions[_ngcontent-%COMP%]{width:120px;text-align:center}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.risks-container[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:20px;font-size:16px;color:#0000008a}.risks-container[_ngcontent-%COMP%]   .impact-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.risks-container[_ngcontent-%COMP%]   .impact-badge.negligible[_ngcontent-%COMP%]{background-color:#e8eaf6;color:#3949ab}.risks-container[_ngcontent-%COMP%]   .impact-badge.low[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.risks-container[_ngcontent-%COMP%]   .impact-badge.medium[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ffa000}.risks-container[_ngcontent-%COMP%]   .impact-badge.high[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.risks-container[_ngcontent-%COMP%]   .impact-badge.severe[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.risks-container[_ngcontent-%COMP%]   .probability-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.risks-container[_ngcontent-%COMP%]   .probability-badge.rare[_ngcontent-%COMP%]{background-color:#e8eaf6;color:#3949ab}.risks-container[_ngcontent-%COMP%]   .probability-badge.unlikely[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.risks-container[_ngcontent-%COMP%]   .probability-badge.possible[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ffa000}.risks-container[_ngcontent-%COMP%]   .probability-badge.likely[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.risks-container[_ngcontent-%COMP%]   .probability-badge.almost_certain[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.risks-container[_ngcontent-%COMP%]   .score-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.risks-container[_ngcontent-%COMP%]   .score-badge.very-low[_ngcontent-%COMP%]{background-color:#e8eaf6;color:#3949ab}.risks-container[_ngcontent-%COMP%]   .score-badge.low[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.risks-container[_ngcontent-%COMP%]   .score-badge.medium[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ffa000}.risks-container[_ngcontent-%COMP%]   .score-badge.high[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.risks-container[_ngcontent-%COMP%]   .score-badge.very-high[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.risks-container[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.risks-container[_ngcontent-%COMP%]   .status-badge.identified[_ngcontent-%COMP%]{background-color:#e0f7fa;color:#0097a7}.risks-container[_ngcontent-%COMP%]   .status-badge.in_assessment[_ngcontent-%COMP%]{background-color:#e0f2f1;color:#00796b}.risks-container[_ngcontent-%COMP%]   .status-badge.mitigated[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#388e3c}.risks-container[_ngcontent-%COMP%]   .status-badge.accepted[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.risks-container[_ngcontent-%COMP%]   .status-badge.closed[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#616161}"]})}}return t})();var li=new H("CdkAccordion");var pn=0,ci=(()=>{class t{get expanded(){return this._expanded}set expanded(e){if(this._expanded!==e){if(this._expanded=e,this.expandedChange.emit(e),e){this.opened.emit();let i=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,i)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(e,i,n){this.accordion=e,this._changeDetectorRef=i,this._expansionDispatcher=n,this._openCloseAllSubscription=re.EMPTY,this.closed=new w,this.opened=new w,this.destroyed=new w,this.expandedChange=new w,this.id=`cdk-accordion-child-${pn++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=n.listen((d,g)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===g&&this.id!==d&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(e=>{this.disabled||(this.expanded=e)})}static{this.\u0275fac=function(i){return new(i||t)(p(li,12),p(te),p(fe))}}static{this.\u0275dir=X({type:t,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[q.HasDecoratorInputTransform,"expanded","expanded",ie],disabled:[q.HasDecoratorInputTransform,"disabled","disabled",ie]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[le([{provide:li,useValue:void 0}]),Z]})}}return t})(),di=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=B({type:t})}static{this.\u0275inj=j({})}}return t})();var gn=["body"],fn=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],hn=["mat-expansion-panel-header","*","mat-action-row"];function xn(t,l){}var _n=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Cn=["mat-panel-title","mat-panel-description","*"];function bn(t,l){if(t&1&&(a(0,"span",1),st(),a(1,"svg",2),C(2,"path",3),o()()),t&2){let e=u();c("@indicatorRotate",e._getExpandedState())}}var pi=new H("MAT_ACCORDION"),mi="225ms cubic-bezier(0.4,0.0,0.2,1)",gi={indicatorRotate:We("indicatorRotate",[oe("collapsed, void",ne({transform:"rotate(0deg)"})),oe("expanded",ne({transform:"rotate(180deg)"})),Ze("expanded <=> collapsed, void => collapsed",Xe(mi))]),bodyExpansion:We("bodyExpansion",[oe("collapsed, void",ne({height:"0px",visibility:"hidden"})),oe("expanded",ne({height:"*",visibility:""})),Ze("expanded <=> collapsed, void => collapsed",Xe(mi))])},fi=new H("MAT_EXPANSION_PANEL"),vn=(()=>{class t{constructor(e,i){this._template=e,this._expansionPanel=i}static{this.\u0275fac=function(i){return new(i||t)(p(dt),p(fi,8))}}static{this.\u0275dir=X({type:t,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0})}}return t})(),Mn=0,hi=new H("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),it=(()=>{class t extends ci{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(e){this._hideToggle=e}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(e){this._togglePosition=e}constructor(e,i,n,d,g,_,E){super(e,i,n),this._viewContainerRef=d,this._animationMode=_,this._hideToggle=!1,this.afterExpand=new w,this.afterCollapse=new w,this._inputChanges=new Ve,this._headerId=`mat-expansion-panel-header-${Mn++}`,this.accordion=e,this._document=g,this._animationsDisabled=_==="NoopAnimations",E&&(this.hideToggle=E.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(rt(null),Y(()=>this.expanded&&!this._portal),at(1)).subscribe(()=>{this._portal=new wt(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(e){this._inputChanges.next(e)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){let e=this._document.activeElement,i=this._body.nativeElement;return e===i||i.contains(e)}return!1}_animationStarted(e){!ui(e)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(e){ui(e)||(e.toState==="expanded"?this.afterExpand.emit():e.toState==="collapsed"&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}static{this.\u0275fac=function(i){return new(i||t)(p(pi,12),p(te),p(fe),p(pt),p(vt),p(ze,8),p(hi,8))}}static{this.\u0275cmp=k({type:t,selectors:[["mat-expansion-panel"]],contentQueries:function(i,n,d){if(i&1&&ft(d,vn,5),i&2){let g;Ke(g=Qe())&&(n._lazyContent=g.first)}},viewQuery:function(i,n){if(i&1&&ht(gn,5),i&2){let d;Ke(d=Qe())&&(n._body=d.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(i,n){i&2&&se("mat-expanded",n.expanded)("_mat-animation-noopable",n._animationsDisabled)("mat-expansion-panel-spacing",n._hasSpacing())},inputs:{hideToggle:[q.HasDecoratorInputTransform,"hideToggle","hideToggle",ie],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[le([{provide:pi,useValue:void 0},{provide:fi,useExisting:t}]),Z,mt,Ge,N],ngContentSelectors:hn,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(i,n){if(i&1){let d=L();Ue(fn),F(0),a(1,"div",1,0),x("@bodyExpansion.start",function(_){return I(d),S(n._animationStarted(_))})("@bodyExpansion.done",function(_){return I(d),S(n._animationDone(_))}),a(3,"div",2),F(4,1),m(5,xn,0,0,"ng-template",3),o(),F(6,2),o()}i&2&&(s(),c("@bodyExpansion",n._getExpandedState())("id",n.id),$e("aria-labelledby",n._headerId),s(4),c("cdkPortalOutlet",n._portal))},dependencies:[Rt],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color);color:var(--mat-expansion-container-text-color);border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font);font-size:var(--mat-expansion-container-text-size);font-weight:var(--mat-expansion-container-text-weight);line-height:var(--mat-expansion-container-text-line-height);letter-spacing:var(--mat-expansion-container-text-tracking)}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color)}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[gi.bodyExpansion]},changeDetection:0})}}return t})();function ui(t){return t.fromState==="void"}var xi=(()=>{class t{constructor(e,i,n,d,g,_,E){this.panel=e,this._element=i,this._focusMonitor=n,this._changeDetectorRef=d,this._animationMode=_,this._parentChangeSubscription=re.EMPTY,this.tabIndex=0;let ae=e.accordion?e.accordion._stateChanges.pipe(Y(D=>!!(D.hideToggle||D.togglePosition))):nt;this.tabIndex=parseInt(E||"")||0,this._parentChangeSubscription=ot(e.opened,e.closed,ae,e._inputChanges.pipe(Y(D=>!!(D.hideToggle||D.disabled||D.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),e.closed.pipe(Y(()=>e._containsFocus())).subscribe(()=>n.focusVia(i,"program")),g&&(this.expandedHeight=g.expandedHeight,this.collapsedHeight=g.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let e=this._isExpanded();return e&&this.expandedHeight?this.expandedHeight:!e&&this.collapsedHeight?this.collapsedHeight:null}_keydown(e){switch(e.keyCode){case 32:case 13:kt(e)||(e.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e);return}}focus(e,i){e?this._focusMonitor.focusVia(this._element,e,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(e=>{e&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static{this.\u0275fac=function(i){return new(i||t)(p(it,1),p(ct),p(yt),p(te),p(hi,8),p(ze,8),lt("tabindex"))}}static{this.\u0275cmp=k({type:t,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(i,n){i&1&&x("click",function(){return n._toggle()})("keydown",function(g){return n._keydown(g)}),i&2&&($e("id",n.panel._headerId)("tabindex",n.disabled?-1:n.tabIndex)("aria-controls",n._getPanelId())("aria-expanded",n._isExpanded())("aria-disabled",n.panel.disabled),ut("height",n._getHeaderHeight()),se("mat-expanded",n._isExpanded())("mat-expansion-toggle-indicator-after",n._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",n._getTogglePosition()==="before")("_mat-animation-noopable",n._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[q.HasDecoratorInputTransform,"tabIndex","tabIndex",e=>e==null?0:bt(e)]},standalone:!0,features:[Z,N],ngContentSelectors:Cn,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(i,n){i&1&&(Ue(_n),a(0,"span",0),F(1),F(2,1),F(3,2),o(),m(4,bn,3,1,"span",1)),i&2&&(se("mat-content-hide-toggle",!n._showToggle()),s(4),gt(4,n._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font);font-size:var(--mat-expansion-header-text-size);font-weight:var(--mat-expansion-header-text-weight);line-height:var(--mat-expansion-header-text-line-height);letter-spacing:var(--mat-expansion-header-text-tracking)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color)}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color)}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color);display:inline-block;display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color);display:none;display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[gi.indicatorRotate]},changeDetection:0})}}return t})();var _i=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=X({type:t,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0})}}return t})();var Ci=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=B({type:t})}static{this.\u0275inj=j({imports:[It,di,At]})}}return t})();function kn(t,l){t&1&&(a(0,"div",9),C(1,"mat-progress-spinner",10),o())}function yn(t,l){if(t&1&&(a(0,"mat-option",15),r(1),o()),t&2){let e=l.$implicit;c("value",e.id),s(),h(" ",e.name," ")}}function In(t,l){if(t&1&&(a(0,"form",11)(1,"mat-form-field",12)(2,"mat-label"),r(3,"Contr\xF4les associ\xE9s"),o(),a(4,"mat-select",13),m(5,yn,2,2,"mat-option",14),o(),a(6,"mat-hint"),r(7,"S\xE9lectionnez un ou plusieurs contr\xF4les \xE0 associer \xE0 ce risque"),o()()()),t&2){let e=u();c("formGroup",e.mappingForm),s(4),c("compareWith",e.compareById),s(),c("ngForOf",e.controls)}}function Sn(t,l){t&1&&(a(0,"span"),r(1,"Enregistrer"),o())}function Pn(t,l){t&1&&C(0,"mat-progress-spinner",16)}var bi=(()=>{class t{constructor(e,i,n,d,g){this.dialogRef=e,this.data=i,this.formBuilder=n,this.controlService=d,this.riskService=g,this.controls=[],this.isLoading=!1,this.isSaving=!1,this.compareById=(_,E)=>_===null||E===null||_===void 0||E===void 0?!1:String(_)===String(E),this.mappingForm=this.formBuilder.group({controlIds:[[],P.required]})}ngOnInit(){this.loadControls()}loadControls(){this.isLoading=!0,this.controlService.getControls().pipe(W(()=>this.isLoading=!1)).subscribe({next:e=>{this.controls=e,console.log("Contr\xF4les disponibles:",this.controls.map(n=>n.id));let i=this.data.controlIds.map(n=>+n);console.log("IDs de contr\xF4les convertis en nombres pour pr\xE9s\xE9lection:",i),this.mappingForm.patchValue({controlIds:i})},error:e=>{console.error("Erreur lors du chargement des contr\xF4les:",e)}})}onSave(){if(this.mappingForm.invalid)return;let e=this.mappingForm.get("controlIds")?.value||[];console.log("Contr\xF4les s\xE9lectionn\xE9s avant envoi:",e),this.isSaving=!0,this.riskService.updateRiskControls(this.data.riskId,e).pipe(W(()=>this.isSaving=!1)).subscribe({next:i=>{console.log("Risque mis \xE0 jour avec succ\xE8s:",i),this.dialogRef.close(i)},error:i=>{console.error("Erreur lors de la mise \xE0 jour des contr\xF4les:",i),i.error&&console.error("D\xE9tails de l'erreur:",i.error)}})}onCancel(){this.dialogRef.close()}static{this.\u0275fac=function(i){return new(i||t)(p(Pe),p(De),p(ye),p(ni),p(K))}}static{this.\u0275cmp=k({type:t,selectors:[["app-risk-control-mapping-dialog"]],standalone:!0,features:[N],decls:11,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["class","loading-container",4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-button","",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],[4,"ngIf"],["mode","indeterminate","diameter","20",4,"ngIf"],[1,"loading-container"],["mode","indeterminate","diameter","50"],[3,"formGroup"],["appearance","fill",1,"full-width"],["formControlName","controlIds","multiple","",3,"compareWith"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mode","indeterminate","diameter","20"]],template:function(i,n){i&1&&(a(0,"h2",0),r(1,"Gestion des contr\xF4les associ\xE9s"),o(),a(2,"div",1),m(3,kn,2,0,"div",2)(4,In,8,3,"form",3),o(),a(5,"div",4)(6,"button",5),x("click",function(){return n.onCancel()}),r(7,"Annuler"),o(),a(8,"button",6),x("click",function(){return n.onSave()}),m(9,Sn,2,0,"span",7)(10,Pn,1,0,"mat-progress-spinner",8),o()()),i&2&&(s(3),c("ngIf",n.isLoading),s(),c("ngIf",!n.isLoading),s(2),c("disabled",n.isSaving),s(2),c("disabled",n.mappingForm.invalid||n.isSaving),s(),c("ngIf",!n.isSaving),s(),c("ngIf",n.isSaving))},dependencies:[G,V,R,Ie,Me,be,ve,Ee,ke,Ae,Te,Re,we,Ne,Fe,Le,Wt,qe,He,me,z,A,je,U,$],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:200px}mat-dialog-content[_ngcontent-%COMP%]{min-height:250px;max-height:400px}mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 0;margin-top:16px}button[disabled][_ngcontent-%COMP%]{cursor:not-allowed}button[_ngcontent-%COMP%]   mat-progress-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}"]})}}return t})();var vi=()=>["/risks"],Dn=t=>["/controls",t];function On(t,l){t&1&&(a(0,"div",5),C(1,"mat-progress-spinner",6),o())}function Tn(t,l){if(t&1&&(a(0,"mat-expansion-panel",13)(1,"mat-expansion-panel-header")(2,"mat-panel-title")(3,"mat-icon"),r(4,"security"),o(),a(5,"span"),r(6,"Plan d'att\xE9nuation"),o()()(),a(7,"p",14),r(8),o()()),t&2){let e=u(2);s(8),f(e.risk.mitigationPlan)}}function wn(t,l){if(t&1&&(a(0,"mat-chip",31),r(1),o()),t&2){let e=l.$implicit;c("routerLink",_t(3,Dn,e.id))("matTooltip",e.description||"Aucune description disponible"),s(),h(" ",e.name," ")}}function Rn(t,l){if(t&1&&(a(0,"div")(1,"mat-chip-set",29),m(2,wn,2,5,"mat-chip",30),o()()),t&2){let e=u(2);s(2),c("ngForOf",e.risk.controls)}}function An(t,l){t&1&&(a(0,"p",32),r(1,"Aucun contr\xF4le n'est associ\xE9 \xE0 ce risque."),o())}function Ln(t,l){if(t&1){let e=L();a(0,"mat-card",7)(1,"mat-card-header")(2,"button",8)(3,"mat-icon"),r(4,"arrow_back"),o()(),a(5,"div",9)(6,"mat-card-title"),r(7),o(),a(8,"mat-card-subtitle",10)(9,"mat-chip-set")(10,"mat-chip",11),r(11),o(),a(12,"mat-chip",12),r(13),o()()()()(),a(14,"mat-card-content")(15,"mat-expansion-panel",13)(16,"mat-expansion-panel-header")(17,"mat-panel-title")(18,"mat-icon"),r(19,"description"),o(),a(20,"span"),r(21,"Description"),o()()(),a(22,"p",14),r(23),o()(),a(24,"mat-expansion-panel",13)(25,"mat-expansion-panel-header")(26,"mat-panel-title")(27,"mat-icon"),r(28,"assessment"),o(),a(29,"span"),r(30,"\xC9valuation du risque"),o()()(),a(31,"div",15)(32,"div",16)(33,"span",17),r(34,"Impact"),o(),a(35,"mat-chip",18),r(36),o()(),a(37,"div",16)(38,"span",17),r(39,"Probabilit\xE9"),o(),a(40,"mat-chip",18),r(41),o()(),a(42,"div",16)(43,"span",17),r(44,"Score"),o(),a(45,"mat-chip",19),r(46),o()(),a(47,"div",16)(48,"span",17),r(49,"Statut"),o(),a(50,"mat-chip",18),r(51),o()()()(),m(52,Tn,9,1,"mat-expansion-panel",20),a(53,"mat-expansion-panel",13)(54,"mat-expansion-panel-header")(55,"mat-panel-title")(56,"mat-icon"),r(57,"verified"),o(),a(58,"span"),r(59,"Contr\xF4les associ\xE9s"),o()()(),a(60,"div",21),m(61,Rn,3,1,"div",22)(62,An,2,0,"ng-template",null,0,Ct),a(64,"div",23)(65,"button",24),x("click",function(){I(e);let n=u();return S(n.openAssociationDialog())}),a(66,"mat-icon"),r(67,"edit"),o(),r(68," Modifier les associations "),o()()()(),a(69,"mat-expansion-panel",25)(70,"mat-expansion-panel-header")(71,"mat-panel-title")(72,"mat-icon"),r(73,"info"),o(),a(74,"span"),r(75,"M\xE9tadonn\xE9es"),o()()(),a(76,"div",26)(77,"div",27)(78,"span",17),r(79,"Cr\xE9\xE9 le"),o(),a(80,"span",28),r(81),J(82,"date"),o()(),a(83,"div",27)(84,"span",17),r(85,"Derni\xE8re mise \xE0 jour"),o(),a(86,"span",28),r(87),J(88,"date"),o()(),a(89,"div",27)(90,"span",17),r(91,"Cat\xE9gorie"),o(),a(92,"span",28),r(93),o()(),a(94,"div",27)(95,"span",17),r(96,"ID"),o(),a(97,"span",28),r(98),o()()()()()()}if(t&2){let e=xt(63),i=u();s(2),c("routerLink",Ye(32,vi)),s(5),f(i.risk.name),s(4),f(i.risk.categoryName||(i.risk.category==null?null:i.risk.category.name)||"Sans cat\xE9gorie"),s(),y(i.getStatusClass(i.risk.status)),s(),h(" ",i.statusTranslations[i.risk.status]," "),s(10),f(i.risk.description||"Aucune description fournie"),s(12),y(i.getImpactLevelClass(i.risk.impactLevel)),s(),h(" ",i.impactLevelTranslations[i.risk.impactLevel]," "),s(4),y(i.getProbabilityLevelClass(i.risk.probabilityLevel)),s(),h(" ",i.probabilityLevelTranslations[i.risk.probabilityLevel]," "),s(4),y(i.getScoreClass(i.risk.score)),s(),h(" ",i.risk.score," "),s(4),y(i.getStatusClass(i.risk.status)),s(),h(" ",i.statusTranslations[i.risk.status]," "),s(),c("ngIf",i.risk.mitigationPlan),s(9),c("ngIf",i.risk.controls&&i.risk.controls.length>0)("ngIfElse",e),s(20),f(ee(82,26,i.risk.createdAt,"dd/MM/yyyy HH:mm")),s(6),f(ee(88,29,i.risk.updatedAt,"dd/MM/yyyy HH:mm")),s(6),f(i.risk.categoryName||(i.risk.category==null?null:i.risk.category.name)||"Non cat\xE9goris\xE9"),s(5),f(i.risk.id)}}function Fn(t,l){t&1&&(a(0,"div",33)(1,"mat-icon"),r(2,"error_outline"),o(),a(3,"h2"),r(4,"Risque non trouv\xE9"),o(),a(5,"p"),r(6,"Le risque demand\xE9 n'existe pas ou a \xE9t\xE9 supprim\xE9."),o(),a(7,"button",34),r(8," Retour \xE0 la liste "),o()()),t&2&&(s(7),c("routerLink",Ye(1,vi)))}var Mi=(()=>{class t{constructor(e,i,n,d,g){this.route=e,this.router=i,this.riskService=n,this.snackBar=d,this.dialog=g,this.risk=null,this.isLoading=!1,this.impactLevelTranslations={NEGLIGIBLE:"N\xE9gligeable",LOW:"Faible",MEDIUM:"Moyen",HIGH:"\xC9lev\xE9",SEVERE:"S\xE9v\xE8re"},this.probabilityLevelTranslations={RARE:"Rare",UNLIKELY:"Peu probable",POSSIBLE:"Possible",LIKELY:"Probable",ALMOST_CERTAIN:"Quasi certain"},this.statusTranslations={IDENTIFIED:"Identifi\xE9",IN_ASSESSMENT:"En \xE9valuation",MITIGATED:"Att\xE9nu\xE9",ACCEPTED:"Accept\xE9",CLOSED:"Cl\xF4tur\xE9"}}ngOnInit(){this.loadRiskDetails()}loadRiskDetails(){this.isLoading=!0;let e=this.route.snapshot.paramMap.get("id");if(!e){this.showError("Identifiant de risque non valide"),this.router.navigate(["/risks"]);return}this.riskService.getRisk(e).pipe(W(()=>this.isLoading=!1)).subscribe({next:i=>{this.risk=i,console.log("Risque charg\xE9:",i)},error:i=>{console.error(`Erreur lors du chargement du risque ${e}:`,i),this.showError("Impossible de charger les d\xE9tails du risque"),this.router.navigate(["/risks"])}})}openAssociationDialog(){if(!this.risk)return;let e=this.risk.controls?this.risk.controls.map(n=>n.id.toString()):[];console.log("Contr\xF4les associ\xE9s au risque:",this.risk.controls),console.log("IDs des contr\xF4les envoy\xE9s au dialogue:",e),this.dialog.open(bi,{width:"600px",data:{riskId:this.risk.id,controlIds:e}}).afterClosed().subscribe(n=>{n&&(console.log("Risque mis \xE0 jour re\xE7u du dialogue:",n),this.risk=n,this.loadRiskDetails(),this.showSuccess("Associations de contr\xF4les mises \xE0 jour avec succ\xE8s"))})}getImpactLevelClass(e){return e?e.toLowerCase():""}getProbabilityLevelClass(e){return e?e.toLowerCase():""}getScoreClass(e){return!e&&e!==0?"":e>=16?"severe":e>=10?"high":e>=5?"medium":"low"}getStatusClass(e){return e?e.toLowerCase():""}showError(e){this.snackBar.open(e,"Fermer",{duration:5e3,panelClass:["error-snackbar"]})}showSuccess(e){this.snackBar.open(e,"Fermer",{duration:3e3,panelClass:["success-snackbar"]})}static{this.\u0275fac=function(i){return new(i||t)(p(Mt),p(de),p(K),p(Se),p(Oe))}}static{this.\u0275cmp=k({type:t,selectors:[["app-risk-detail"]],standalone:!0,features:[N],decls:4,vars:3,consts:[["noControls",""],[1,"risk-detail-container"],["class","loading-shade",4,"ngIf"],["class","risk-card",4,"ngIf"],["class","not-found",4,"ngIf"],[1,"loading-shade"],["mode","indeterminate","diameter","50"],[1,"risk-card"],["mat-icon-button","","matTooltip","Retour \xE0 la liste",1,"back-button",3,"routerLink"],[1,"header-content"],[1,"risk-metadata"],[1,"category-chip"],[1,"status-chip"],["expanded","true",1,"section-panel"],[1,"section-content"],[1,"risk-metrics-grid"],[1,"metric-item"],[1,"label","mat-caption"],[1,"value-chip"],[1,"value-chip","score-chip"],["expanded","true","class","section-panel",4,"ngIf"],[1,"controls-content"],[4,"ngIf","ngIfElse"],[1,"actions-container"],["mat-raised-button","","color","primary",3,"click"],[1,"section-panel"],[1,"metadata-grid"],[1,"metadata-item"],[1,"value","mat-body-1"],[1,"controls-chip-list"],["color","accent","class","control-chip",3,"routerLink","matTooltip",4,"ngFor","ngForOf"],["color","accent",1,"control-chip",3,"routerLink","matTooltip"],[1,"no-data-message"],[1,"not-found"],["mat-raised-button","","color","primary",3,"routerLink"]],template:function(i,n){i&1&&(a(0,"div",1),m(1,On,2,0,"div",2)(2,Ln,99,33,"mat-card",3)(3,Fn,9,2,"div",4),o()),i&2&&(s(),c("ngIf",n.isLoading),s(),c("ngIf",n.risk),s(),c("ngIf",!n.risk&&!n.isLoading))},dependencies:[G,V,R,ce,pe,Et,ge,St,Dt,Tt,Ot,Pt,xe,he,z,A,ue,U,$,Be,ei,ti,Ce,_e,Ci,it,xi,_i,Lt],styles:[".risk-detail-container[_ngcontent-%COMP%]{padding:16px;max-width:1200px;margin:0 auto;position:relative}.loading-shade[_ngcontent-%COMP%]{position:absolute;inset:0;background:#00000026;z-index:10;display:flex;align-items:center;justify-content:center}.risk-card[_ngcontent-%COMP%]{margin-bottom:20px;overflow:hidden}mat-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:16px;padding-bottom:16px;border-bottom:1px solid rgba(0,0,0,.12)}.back-button[_ngcontent-%COMP%]{margin-right:16px}.header-content[_ngcontent-%COMP%]{flex:1}mat-card-title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px}.risk-metadata[_ngcontent-%COMP%]{margin-top:8px}.section-panel[_ngcontent-%COMP%]{margin-bottom:16px;box-shadow:0 2px 4px #0000001a!important}.section-content[_ngcontent-%COMP%]{padding:16px;white-space:pre-wrap;line-height:1.5}.risk-metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;padding:16px}.metric-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.label[_ngcontent-%COMP%]{font-weight:500;color:#0009}.metadata-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:16px;padding:16px}.metadata-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.controls-content[_ngcontent-%COMP%]{padding:16px}.controls-chip-list[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;flex-wrap:wrap;gap:8px}.control-chip[_ngcontent-%COMP%]{cursor:pointer}.actions-container[_ngcontent-%COMP%]{margin-top:16px;display:flex;justify-content:flex-end}.no-data-message[_ngcontent-%COMP%]{color:#0000008a;font-style:italic}.value-chip[_ngcontent-%COMP%]{font-weight:500}.identified[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#0d47a1}.in_assessment[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff6f00}.mitigated[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.accepted[_ngcontent-%COMP%]{background-color:#f3e5f5;color:#7b1fa2}.closed[_ngcontent-%COMP%]{background-color:#eee;color:#616161}.negligible[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.low[_ngcontent-%COMP%]{background-color:#c8e6c9;color:#1b5e20}.medium[_ngcontent-%COMP%]{background-color:#fff8e1;color:#ff6f00}.high[_ngcontent-%COMP%]{background-color:#ffccbc;color:#bf360c}.severe[_ngcontent-%COMP%]{background-color:#ffcdd2;color:#b71c1c}.score-chip[_ngcontent-%COMP%]{font-weight:700;min-width:40px;justify-content:center}.not-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.not-found[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;height:48px;width:48px;margin-bottom:16px;color:#00000061}@media (max-width: 600px){.risk-metrics-grid[_ngcontent-%COMP%], .metadata-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}mat-card-title[_ngcontent-%COMP%]{font-size:20px}.actions-container[_ngcontent-%COMP%]{justify-content:center}}"]})}}return t})();var Nn=[{path:"",component:si},{path:":id",component:Mi}],Sa=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=B({type:t})}static{this.\u0275inj=j({imports:[G,pe.forChild(Nn),Ie,Jt,Kt,z,xe,Qt,Ae,Ne,je,qe,U,Ce,Be,ge]})}}return t})();export{Sa as RisksModule};
